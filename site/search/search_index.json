{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"OnGuard XProtect Access integration user guide","text":"<p>For more info   mjt@milestone.us</p> <p></p>"},{"location":"AdminConfig/","title":"Door &amp; camera association","text":"<p>In the Doors and Associated Cameras menu of the XProtect Access Instance it's possible to verify the status of all connected doors, and create, reassign, and remove the association between cameras and doors. Doors require associated cameras to view live and recorded video - and listen to or play audio through any XProtect client that supports visualization of doors.</p> <ol> <li>Open the doors list and select a panel to view all doors connected to that panel.    </li> <li>Select a door. A list of all associated cameras appears under the door object.</li> <li>Select a camera from the Cameras list on the right and drag the selected camera into the list of cameras associated to the chosen door.    </li> <li>Click the Remove link if you need to end the association between the camera and the door.</li> </ol>"},{"location":"AdminConfig/ACEventCats/","title":"Access control event categories","text":"<p>Below is the list of all access control event categories.</p>"},{"location":"AdminConfig/ACEventCats/#default-xprotect-access-events","title":"Default XProtect Access events:","text":"<ul> <li>Access Granted</li> <li>Access Request</li> <li>Access Denied</li> <li>Alarm</li> <li>Error</li> <li>Warning</li> </ul>"},{"location":"AdminConfig/ACEventCats/#onguard-events","title":"OnGuard events:","text":"<ul> <li>OnGuard Access Denied</li> <li>OnGuard Access Granted</li> <li>OnGuard Area ABP</li> <li>OnGuard Asset</li> <li>OnGuard Biometric</li> <li>OnGuard Burglary</li> <li>OnGuard C900</li> <li>OnGuard Digitize</li> <li>OnGuard Duress</li> <li>OnGuard Fire 7</li> <li>OnGuard Fire 8</li> <li>OnGuard Fire 9</li> <li>OnGuard Gas</li> <li>OnGuard Generic</li> <li>OnGuard Host Messages</li> <li>OnGuard Intercom</li> <li>OnGuard Medical</li> <li>OnGuard Muster</li> <li>OnGuard Open/Close</li> <li>OnGuard Point of Sale</li> <li>OnGuard Portable Programmer</li> <li>OnGuard Relay/Sounder</li> <li>OnGuard System</li> <li>OnGuard Temperature</li> <li>OnGuard Transmitter</li> <li>OnGuard Trouble</li> <li>OnGuard Video</li> <li>OnGuard Water</li> <li>OpenAccess Call Failure</li> </ul>"},{"location":"AdminConfig/ACEventCats/#custom-events","title":"Custom events:","text":"<ul> <li>User Defined Category...</li> </ul> <p>To create a user-defined category, there is a User-defined Categories button on the bottom left corner of the Access control events menu.</p> <ol> <li>Click the User-defined Categories button to create your own custom event category. </li> <li>Click Add, name the category, and press OK. The user-defined category appears as an option in the Event Category list. </li> </ol>"},{"location":"AdminConfig/AccessRequestNotifications/","title":"Access request notifications","text":"<p>Access request notifications are pop-up notifications which appear in front of all other desktop applications for all users logged into the Smart Client with privileges to view XProtect Access features and devices. The XProtect Access integration includes a built-in access request notification. Use the Access Request Notifications menu to customize these notifications.</p> <ol> <li>Go to the Access Request Notification menu. </li> <li>Click the Add Access Request Notification button.</li> <li>Name the new notification.</li> <li>Associate cameras, speakers, microphones, and sounds.</li> <li>Click the Add Command button and open the Command list to select which commands appear on the notification.</li> </ol> <p></p> <p>Notification options</p> <p>When the notification pops up on the desktop, a sound plays if you choose to include an audible notification. The built-in access request notification doesn't include a sound.</p> <p>Access request notifications can trigger pop up notifications from the XProtect rules system, and these notifications don't need to be related to access control hardware devices.</p> <p></p>"},{"location":"AdminConfig/CategorizeEvents/","title":"Categorize events","text":"<p>Large scale access control systems, such as those managed by OnGuard, need to functionally integrate with XProtect without programming large numbers of individual alarms and rules. Categorizing access control events minimizes the number of individual alarms and rules requiring programming.</p> <p>Categorize events to generate XProtect alarms or rule-based actions triggered by any OnGuard event from the chosen category. For example, the integration can start recording video based on any number of unique OnGuard hardware events: \u201cDoor Forced,\u201d \u201cDenied, Badge Not in Panel,\u201d and \u201cAccess Denied Unauthorized Entry Level.\u201d Categorize the events, then create a rule to start recording based on events from that category.</p> <ol> <li>Go to the Access Control Events tab of the XProtect Access instance in the Management Client.</li> <li>Select an event, and choose a category from the Event Category list.</li> <li>Apply the same category to any number of events.</li> <li>When creating rules and alarms within XProtect, if you choose an Access Control Category as the trigger, any of the events that are in the chosen category cause the rule or alarm to happen.</li> <li>Alarms and Rules in XProtect can trigger using any category of event.<ul> <li>Alarm Access Control Event Categories list: </li> <li>Rule Access Control Categories event list: </li> </ul> </li> </ol>"},{"location":"AdminConfig/ClientProfilesRoles/","title":"Client profiles &amp; Roles explained","text":"<p>Smart Client profiles and user roles in XProtect let administrators manage the features available in the XProtect Smart Client.</p> <p>Smart Client profiles control visibility of access request notifications. Roles define visibility and control of access control features, visibility of the cardholder list, and access request notifications. For example, if a user can't receive access request notifications, their ability to receive notifications can be controlled in either their Smart Client profile or their role.</p>"},{"location":"AdminConfig/ManageClientProfilesRoles/","title":"Managing client profiles &amp; Roles","text":"<ol> <li>To manage Smart Client profiles:<ul> <li>Open the Management Client.</li> <li>Expand Client and select Smart Client profiles.</li> <li>The Access Control menu has the setting for notifications. </li> </ul> </li> <li>To manage user roles:<ul> <li>Open the Management Client.</li> <li>Expand Security and select Roles.</li> <li>Select the role to manage and click the Access Control menu to adjust the available settings. </li> </ul> </li> </ol> <p>Receive notifications</p> <p>The Receive notifications setting only applies to the XProtect mobile client.</p>"},{"location":"AdminConfig/SearchingCardholders/","title":"Searching for cardholders explained","text":"<p>All active cardholders in the OnGuard system are imported to the integration. Active cardholders have one or more badge(s) with a status of \u201cactive.\u201d Search for cardholders in the Cardholders menu of the XProtect Access instance. First Name, Last Name, Badge Numbers, and Cardholder ID are all included in the search. As characters are typed in the box, searching begins:</p> <p></p> <p>Visibility of cardholder information, such as name and badge numbers, comes from the OnGuard database.</p> <p>Modify cardholder data</p> <p>Edit the PluginSettings.json configuration file to change the data available within each cardholder record, and change the order of data display. To learn more read: Cardholder search data fields are missing, or out of order</p>"},{"location":"Install/","title":"Installation program (explained)","text":"<p>The installation package consists of one context sensitive installer program:</p> <ul> <li>XProtectAccess.OnGuard.msi</li> </ul> <p>This program detects which server it's running on (OnGuard or XProtect), and installs the following software components:</p> <ol> <li>OnGuard XProtect Access Service - installed on the OnGuard server, or its own integration server.</li> <li>OnGuard XProtect Access MipPlugin - installed on the XProtect Event Server host machine or on a standalone Milestone XProtect Management Server. </li> </ol> <p>Integration Server Process and OnGuard Server on the same machine. <pre><code>flowchart LR\n    a(\"OnGuard XProtect Access MIP Plugin\"):::XPClass -- \"HTTP REST API\" --&gt; b(\"OnGuard XProtect Access Service\"):::XPClass\n    b(\"OnGuard XProtect Access Service\"):::XPClass -- \"SIGNALR Events\" --&gt; a(\"OnGuard XProtect Access MIP Plugin\"):::XPClass\n\n    subgraph \"OnGuard Server\"\n        direction TB\n        subgraph \"Integration Server Process\"\n        b(\"OnGuard XProtect Access Service\"):::XPClass\n        end\n    b(\"OnGuard XProtect Access Service\"):::XPClass &lt;--&gt; c(\"OnGuard OpenAccess Service\"):::XPClass\n    end\n    subgraph \"XProtect Management Server\"\n        direction TB\n        subgraph \"XProtect Event Server Process\"\n        a(\"OnGuard XProtect Access MIP Plugin\"):::XPClass\n        end\n    end \n    classDef XPClass fill:#efb, stroke:#000, stroke-width:2px</code></pre></p> <p>Or</p> <p>Integration server process (OnGuard XProtect Access Service) hosted on a separate machine. <pre><code>flowchart LR\n    A--&gt;|HTTP Rest API|B\n    B&lt;--&gt;|OpenAccess HTTPS API|C\n    B--&gt;|SIGNALR Events|A\n    subgraph XProtect Management Server\n        subgraph XProtect Event Server\n        A[OnGuard XProtect Access MIP Plugin]:::XPClass\n        end\n    end\n    subgraph Integration Server\n    B[OnGuard XProtect Access Service]:::XPClass\n    end\n    subgraph OnGuard\n    C[OnGuard OpenAccess Services]:::XPClass\n    end\n\n    classDef XPClass fill:#efb, stroke:#000, stroke-width:2px</code></pre></p> <p>Plugin version requirements</p> <p>It's required that the exact same versions of the OnGuard XProtect Access integration software components are installed on both the OnGuard and XProtect machines.</p>"},{"location":"Install/DataConduIT/","title":"Upgrading from DataConduIT","text":"<p>Any XProtect Access integration using the DataConduIT connection mode can't upgrade directly to versions 4.0 or newer. DataConduIT is only compatible with XProtect Access versions 3.4 or older. All systems running DataConduIT must enable OpenAccess, upgrade to version 3.6 of the integration, and then upgrade to the most recent version. Perform the following procedure to upgrade.</p> <ol> <li>Apply the OpenAccess license.<ul> <li>Contact CARRIER to enable the OpenAccess Integration license (ITM-MLST-001) and the Partner Integration license (IPC-311-MLST01).</li> <li>Once you have the OpenAccess license, go to the License Administration app on the OnGuard server. Go to Start &gt; All Programs &gt; OnGuard (X.X), select License Administration and then log in.</li> <li>On the left side of the web interface select Install new license.</li> <li>Upload the new license file to enable the OpenAccess features.</li> </ul> </li> <li> <p>Verify that OpenAccess configuration in OnGuard.</p> <ul> <li>Go to Start &gt; All Programs &gt; OnGuard (X.X), select System Administration.</li> <li>In the System Administration client, go to the Administration menu and select System Options.</li> <li>Identify the host(s) running the Message Broker Service and OpenAccess services: </li> <li> <p>On the host(s), confirm that the following services are all running:</p> OnGuard Service Name Known Good Service Locations LS Message Broker On the identified host LS OpenAccess On the identified host LS Web Service By default LS Web Service runs on the same host as the LS OpenAccess service. LS Event Context Provider Must run on the same host as the LS OpenAccess service LS Web Event Bridge By default LS Web Event Bridge runs on the same host as the LS OpenAccess service. </li> </ul> </li> <li> <p>Verify prerequisites installed to support the 3.6 version of the OnGuard XProtect Access plug-in.</p> <ul> <li>Each downloadable .ZIP file available at download.milestonesys.com/lenels2xpa has a prerequisites folder containing any required installation programs.</li> </ul> </li> <li>Upgrade your OnGuard XProtect Access Plugin to Version 3.6.<ul> <li>Always upgrade the ACM Server and the OnGuard ACM plugin on the OnGuard machine before upgrading the XProtect Event Server ACM MIP plugin.</li> <li>On the OnGuard Server, first install the Milestone ACM Server.</li> <li>Second, install the Milestone ACM Server: OnGuard Plugin.</li> <li>Lastly, move to the XProtect Event Server and install the XProtect Event Server ACM MIP Plugin.</li> <li>Here is the order of installation for all three software components of the plug-in: </li> <li>Refresh the configuration on the OnGuard XProtect Access instance in the Management Client.</li> <li>Now, the active OnGuard XProtect Access instance is using OpenAccess connection mode, and running version 3.6.</li> <li>An upgrade directly to version 4.3 is supported.</li> </ul> </li> <li>Verify the prerequisites are in place to support version 4.3.</li> <li>On the OnGuard Server first install the OnGuard XProtect Access Service.</li> <li>Next move to the XProtect Event Server and install the OnGuard XProtect Access MipPlugin.</li> <li>Refresh the configuration on the OnGuard XProtect Access instance in the Management Client and reconfigure the connection properties in the General Settings tab as required.</li> <li>Reconfigure any rules triggered by access control events or event categories. Read: Access control rules stop working after upgrade to 4.0 or newer.</li> </ol>"},{"location":"Install/Step1Install/","title":"Step 1: Installing OnGuard XProtect Access Service","text":"<ol> <li>Double-click the XProtectAccess.OnGuard.msi file to begin.</li> <li>The installation wizard launches. Click Next to continue. </li> <li>The context sensitive wizard offers to install the required components for the OnGuard XProtect Access Service. Click Next to continue. </li> <li>Optionally, expand the server icon menu to view installation options. The Reset button returns the wizard to all default options. </li> <li>Choose the account used to run the OnGuard XProtect Access Service. The wizard selects the LocalSystem account by default. Click Next. </li> <li>The ready to install step confirms the wizard can begin installation. Click Install. </li> <li>Installation is complete. Click Finish. </li> </ol>"},{"location":"Install/Step2Install/","title":"Step 2: Installing OnGuard XProtect Access MipPlugin","text":"<ol> <li>Place the XProtectAccess.OnGuard.msi file on the server hosting the XProtect Event Server (in a typical deployment, this is the Milestone XProtect Management Server), and double-click the file to begin.</li> <li>After the opening step, the context sensitive installation wizard offers the option to install the OnGuard XProtect Access MipPlugin. Click Next to continue. </li> <li>Optionally, expand the server icon menu to view installation options. The Reset button returns the wizard to all default options. </li> <li>The ready to install step confirms the wizard can begin installation. Click Install. </li> <li>You have installed the OnGuard XProtect Access MipPlugin. Click Finish. </li> </ol>"},{"location":"Install/Uninstall/","title":"Uninstalling the integration","text":"<p>When uninstalling the integration software to revert to an older version, please refer to Integration version downgrades.</p> Warning <p>When uninstalling both the OnGuard XProtect Access MipPlugin software and the XProtect Event Server on the same server, it's required to first uninstall the OnGuard XProtect Access MipPlugin components and uninstall the Event Server afterward. If the Event Server is uninstalled first, the integration software fails to uninstall.</p> <p>Below is the process required to uninstall the 4.3 version of the plugin:</p> <ol> <li>Go to the Programs and Features menu on the Milestone server.</li> <li>Uninstall the Milestone OnGuard XProtect Access plug-in.</li> <li>Go to the Programs and Features menu on the OnGuard server.</li> <li>Uninstall the Milestone OnGuard XProtect Access service.</li> </ol>"},{"location":"Install/Upgrades/","title":"Integration version upgrades","text":"<p>All components are updated with every new OnGuard XProtect Access release. The installation program is designed to automatically remove and replace the required files and folders during an upgrade from older versions of the integration.</p>"},{"location":"Install/Upgrades/#upgrade-process","title":"Upgrade process:","text":"<p>The process for upgrading can follow any order. However, the recommended order is as follows:</p> <ol> <li>Go to the OnGuard server(s) - All OnGuard machines where the ACM Server is installed.</li> <li>Run the XProtectAccess.OnGuard.msi installation program. It performs the following actions:<ul> <li>Uninstall the ACM Server OnGuard Plugin</li> <li>Uninstall the ACM Server</li> <li>Install the OnGuard XProtect Access Service.</li> </ul> </li> <li>Go to the XProtect server(s) Milestone XProtect Event Server hosts where the Mip Plugin is installed.</li> <li>Run the XProtectAccess.OnGuard.msi installation program. It performs the following actions:<ul> <li>Uninstall the Mip Plugin and the ACM Wizard</li> <li>Remove the folder created by the ACM Wizard for OnGuard at the default location (C:\\Program Files\\Milestone\\MipPlugins\\OnGuardACMServer)</li> <li>Install the OnGuard XProtect Access MipPlugin and create a new folder at the default location (C:\\Program Files\\Milestone\\MipPlugins)</li> </ul> </li> </ol> <p>Automatic upgrades of configured and installed instances in the Management Client are supported for all versions of the OnGuard XProtect Access integration. Run the XProtectAccess.OnGuard.msi installer; it upgrades any installed components. The system should be up and running, fully functional, after the upgrade.</p>"},{"location":"Install/Upgrades/#upgrading-from-40-or-older","title":"Upgrading from 4.0 or older?","text":"<p>Versions 4.1 and higher of the integration add two fields to the General Settings menu in the Management Client to define the connection between the OnGuard XProtect Access MipPlugin (on the XProtect server) and the OnGuard XProtect Access Service. These are XProtect Access Server - Host: and XProtect Access Server - Port:</p> <p></p> <p>The upgrade process fills the Port field with the default value of 8443, but the Host field remains empty. Before saving any changes in the Management Client the host value is required. During the upgrade, the configuration value for the host field is retained from the old version of the integration from the \"connection profile\" setting. This is why the integration continues to function. However, once it's opened, the UI logic of the Management Client requires this field to be populated and saved accurately.</p> <ol> <li>Open the XProtect Management Client.</li> <li>In the General Settings tab of the upgraded OnGuard XProtect Access instance, enter the hostname for the OnGuard server or the Integration Server in the XProtect Access Service - Host: field.</li> <li>Save the changes in the Management Client.</li> </ol> Rules stop working after upgrade? <p>Upgrading to 4.0 or higher from older versions requires reconfiguration of all rules in XProtect triggered by access control events or event categories. Door hardware objects aren't supported as event sources in 4.0 or newer versions, readers are used instead. Read more here: Access control rules stop working after upgrade to 4.0 or newer.</p>"},{"location":"Intro/","title":"Executive summary","text":"<p>This document describes the OnGuard XProtect Access integration between XProtect video management system (VMS) and the OnGuard access control (AC) system. </p> <pre><code>graph LR\n    OnGuard([OnGuard])\n    XProtect([XProtect])\n    OnGuard --&gt; XProtect\n</code></pre> <p>This integration supports the following standard XProtect Access features:</p> <ul> <li>Retrieve and refresh configuration from the OnGuard AC system, e.g. doors and event types</li> <li>Receive AC event streams and hardware status changes from the OnGuard system</li> <li>Display and search cardholder information - both data and images.</li> <li>Create alarms in XProtect Smart Client alarm manager based on AC events.</li> <li>Synchronization of alarm status between XProtect and OnGuard.</li> <li>Association of access control events to cameras for simultaneous display of events and video.</li> <li>Association of access control hardware to cameras for simultaneous display of doors and video.</li> <li>Select and categorize events from the OnGuard system to view and work with events in groups.</li> <li>Trigger system actions based on AC hardware events. For example: start recording, go to PTZ preset, display access request, triggered by door forced, access granted, and access denied.</li> <li>Personalized login to support segmented database systems.</li> <li>AC hardware status display and command interaction on VMS client map user interface.</li> <li>Create customized access reports based on search queries in XProtect Smart Client.</li> <li>Smart Client pop-up access request notifications.</li> <li>AC hardware interaction via XProtect web and mobile clients.</li> <li>Connect to the OnGuard web administration interface from the Smart Client.</li> </ul>"},{"location":"Intro/CurrentDoc/","title":"Current version","text":"Version Notes 4.3 Current documentation refers to integration versions 4.3 and newer. <p>For more information on earlier versions, check version specific documents. For version specific change details, check release notes available with each version\u2019s documentation.</p>"},{"location":"Intro/New43/","title":"Whats new in version 4.3?","text":"<p>The most prominent changes to version 4.3 of the OnGuard XProtect Access integration are listed below.</p> <p>Requirements:</p> <ul> <li>OnGuard and XProtect version support statement: OnGuard &amp; XProtect Compatibility.</li> </ul> <p>Features &amp; User Experience:</p> <ul> <li>Improved explanation of personalized log-in errors in the Smart Client. Refreshing personalized login</li> <li>Basic troubleshooting checklist added to user guide. Basic support checklist</li> <li>Developer tabs explained in user guide. XProtect Access developer tabs (explained)</li> <li>Bug fix for duplicate events in Smart Client.</li> <li>Improved event handling performance.</li> </ul>"},{"location":"Intro/SolutionOverview/","title":"Solution overview","text":"<p>The solution provided has two components:</p> <ol> <li>OnGuard XProtect Access Service - Typically installed in the OnGuard environment.</li> <li>OnGuard XProtect Access MipPlugin - Installed in the XProtect environment.</li> </ol> <pre><code>flowchart LR\n    a(\"OnGuard XProtect Access MIP Plugin\"):::XPClass -- \"HTTP REST API\" --&gt; b(\"OnGuard XProtect Access Service\"):::XPClass\n    b(\"OnGuard XProtect Access Service\"):::XPClass -- \"SIGNALR Events\" --&gt; a(\"OnGuard XProtect Access MIP Plugin\"):::XPClass\n    subgraph \"OnGuard Server\"\n    b(\"OnGuard XProtect Access Service\"):::XPClass &lt;--&gt; c(\"OnGuard OpenAccess Service\"):::XPClass\n    b(\"OnGuard XProtect Access Service\"):::XPClass &lt;--&gt; d[(\"OnGuard Database\")]:::XPClass\n    end\n    subgraph \"XProtect Management Server\"\n        direction TB\n        subgraph \"XProtect Event Server Process\"\n        a(\"OnGuard XProtect Access MIP Plugin\"):::XPClass\n        end\n    end \n    classDef XPClass fill:#efb, stroke:#000, stroke-width:2px</code></pre>"},{"location":"MCConfig/","title":"XProtect Access instance creation wizard","text":"<p>After installing the OnGuard XProtect Access MipPlugin on the XProtect Event Server, create the access control instance in the XProtect Management Client.</p> <ol> <li>Right-click the Access Control root node and select Create new... to begin the wizard.    </li> <li>Enter a name for the instance and select the Integration plug-in. Select the plug-in named LenelS2 OnGuard.    </li> <li>After naming and selecting the plug-in there are a set of required credentials, parameters, and options to complete. These fields define the connection to the OnGuard server. All properties for all supported versions of OnGuard are in the Management Client wizard. <p>   + Below are the fields required to establish the connection. It's possible to populate any field at this step in the process, the fields listed are the minimum required.</p> Empty Field Names Required Values XProtect Access Service - Host: Hostname of the OnGuard server or the Integration server. XProtect Access Service - Port: Default port is 8443. OpenAccess - Host: IP address for the OnGuard server. OpenAccess - Port: Default port is 8080. OpenAccess - User: SSO user defined in OnGuard OpenAccess - Password: Password for the SSO user in OnGuard. OpenAccess - Directory: Directory for the SSO user in OnGuard. </li> <li>After connection, the wizard imports data from the OnGuard server. This includes Doors, Units, Servers, Events, Commands, and States. Click Next. </li> <li>Associate doors with cameras. Select a camera and drag it to a door.    </li> <li>Click Next after association of doors and cameras.</li> <li>The configuration is saved, and the wizard ends.</li> </ol>"},{"location":"MCConfig/Commands/","title":"Commands explained","text":"<p>Commands in the XProtect Access OnGuard integration interact with access control devices. By default, commands are disabled in the plugin configuration. This can be changed in the XProtect Management Client by clearing the Options - Disable Commands checkbox.</p> <p>If commands are turned off, none of the command features work, however it's still possible to view command buttons in the Smart Client and create rules in XProtect which use commands. These rules validate, and the buttons appear, but nothing happens. In the Smart Client users receive the following error message:</p> <p><code>HH:MM:SS AM/PM Failed to perform the access control command \u2018**COMMAND**\u2019 on \u2018**DEVICE**\u2019. Error Message: Commands are disabled. Modify the plugin configuration in the XProtect Management Client to enable commands.</code></p> <p></p> <p>Commands are used to trigger state changes in the access control hardware devices. Commands trigger in four ways with the XProtect Access OnGuard integration: </p> <ol> <li>The XProtect rules system can trigger commands.</li> <li>Access request notifications can include commands.</li> <li>Any location in the Smart Client where doors are visualized, such as the access monitor or the access control workspace, can contain command buttons.</li> <li>The map interface within the XProtect Smart Client can include access control device icons which can be used to trigger commands.</li> </ol>"},{"location":"MCConfig/ConnectionProperties/","title":"XProtect Access instance status &amp; properties","text":"<p>Go to the Access Control menu in the directory tree of the XProtect Management Client. You can view status of all instances by selecting the root of the Access Control directory.</p> <p></p> <p>Select your OnGuard XProtect Access instance to view or edit the properties of the connection.</p> <p></p> <p>Descriptions for all properties listed below:</p> Property Name Description - Purpose Enable: Selected by default. Remain selected to keep connection properties active. Name: Custom name field. Description: Reference information field. Integration plug-in: Displays the current version of the OnGuard XProtect Access MipPlugin. Last configuration refresh: Displays the date and time of the last system configuration refresh. Operator login required: Not selected by default. Select this option to enable the personalized login feature. XProtect Access Service - Host: Host name of the OnGuard server or the Integration Server hosting the OnGuard XProtect Access Service. XProtect Access Service - Port: 8443 is the default port. XProtect Access Service - SSL Certificate Validation Not selected by default. Choose this option to secure communication between the OnGuard XProtect Access Service and the XProtect Event Server. OpenAccess \u2013 Host: IP address of the machine hosting the OnGuard OpenAccess service in non-encrypted scenarios. This field must use fully qualified domain name (FQDN) of the server to support SSL authentication. See the note below for scenarios where the OpenAccess service and the XProtect Access Service are installed on the same server. OpenAccess \u2013 Port: The port the OnGuard OpenAccess service is listening on. 8080 is the default port. OpenAccess - SSL Certificate Validation Not selected by default. Choose this option to secure communication between the OnGuard XProtect Access Service and the OnGuard OpenAccess Service. OpenAccess \u2013 User: An OnGuard administrative user to log into the OnGuard OpenAccess web service. This user should have access to all hardware, cardholders, etc in the system. Windows user account if using Directory users, OnGuard internal user account if using internal directory. OpenAccess \u2013 Password: The password of an OnGuard user to log into the OnGuard OpenAccess web service. In XProtect versions 2021 R1 and newer, after entering the password, this field is replaced by the Enter current password\u2026 button in the General Settings tab. If the SSO user account is changed to update the integrated hardware device set, or the current user\u2019s password needs updating - click the button to open a dialog box. OpenAccess \u2013 Directory: The name of the OnGuard directory used for logging into the OnGuard OpenAccess web service. If left blank, the OnGuard internal directory is used. Options \u2013 OnGuard Web Administration URL: A URL for the OnGuard web-based administration portal. This field creates a link to the portal from the Smart Client Access Control workspace. By default the location for this URL is: https://HostName:8080/#/Login - Where \"HostName\" is the hostname of the OnGuard server. Options \u2013 Disable Commands: Selected by default. This option controls all command interaction between XProtect and OnGuard access control hardware devices. Options \u2013 States polling interval (seconds): Default value is 900 seconds. Frequency of status updates retrieved for AC hardware devices. Increase this value for more consistent event processing throughput. Options \u2013 '[Legacy]' OnGuard SQL Server hostname: SQL server hostname in systems upgraded from 3.X versions to the current 4.X version which doesn't require a SQL server hostname to establish the connection. Options \u2013 [Legacy] Connection Profile: This value is automatically filled for systems upgrading to 4.1 or newer versions of the integration from a 4.0 or older version. Options - Enable performance metrics (diagnostics): Not selected by default. Select this option to include performance statistic logging on event metadata. <p>You can verify that the integration module is now connected by looking at the access control tree.</p> Trouble connecting using encrypted communication <p>In scenarios where the OpenAccess service and the XProtect Access Service are located on the same server, the OpenAccess - Host field must contain the PC name of the server where the OpenAccess service is installed in order to use SSL encryption between the OpenAccess service and the Event Server. In these scenarios the process used to create the certificate specifies the PC name, and any other method of identification for the server - such as the IP address or the fully qualified domain name - will not work. Make sure to match the PC name with the data entered in the OpenAccess - Host field.</p>"},{"location":"MCConfig/EnablePersonalizedLogin/","title":"Enabling or disabling personalized login","text":"<p>Enable or disable personalized login for a specific access control plug-in in the Management Client. The option is located in the general settings menu and is titled Operator login required:</p> <p></p> <p>After choosing to enable or disable this feature, make sure to save your changes in the Management Client.</p>"},{"location":"MCConfig/PersonalizedLogin/","title":"Personalized login explained","text":"<p>Personalized login is an optional feature of XProtect Access. Personalized login links OnGuard user privileges to the access control hardware, events, and alarms available in the XProtect Access integration. </p> <p>When a user logs into Smart Client, the personalized login feature presents a second login procedure that authenticates with the integrated OnGuard system. When the user presents valid OnGuard credentials, the Smart Client\u2019s XProtect Access features are narrowed to access control hardware, events, and alarms within that user\u2019s OnGuard privileges.</p> <p>Personalized login manages two configurations. First, is the global configuration used by the Management Client. Second, is the personalized configuration used in the Smart Client. Personalized configurations are subsets of the global configuration. This helps control accuracy of event handling, command execution, and device management.</p> <p>Requirements</p> <p>Personalized login has specific requirements: <ul> <li>OnGuard 7.4 or higher</li> <li>XProtect Access 3.5 or higher</li> </ul></p>"},{"location":"MCConfig/RefreshPL/","title":"Refreshing personalized login","text":"<p>The XProtect Event Server stores personalized configurations for XProtect Smart Client users. Stored personalized configurations vanish when the Event Server restarts. When the global configuration of the XProtect Access instance refreshes, the Event Server updates all stored personalized configurations. Changes to this configuration can cause error messages for users logged into the Smart Client. Below, are two possible error messages, known causes, and how to fix them.</p> <p>Smart Client system configuration error messages</p> <p>After the global configuration updates, all open Smart Clients using a personalized configuration display the following info message.  Log out of the Smart Client and log back in using the personalized configuration to load the updated configuration.</p> <p>Smart Client OnGuard disconnect error messages</p> <p>The following error message that the system has been disabled can result from a modified OnGuard segment configuration for the current logged in operator.  Log out of the Smart Client and log back in to restore integrated access control system functionality.</p>"},{"location":"MCConfig/SCLoginWPL/","title":"Logging into Smart Client with personalized login","text":"<p>After you launch the Smart Client and login, the personalized login feature presents a second login dialog for OnGuard.</p> <p></p> <p>OnGuard requires three pieces of data during this exchange:</p> <ol> <li>directory</li> <li>user name</li> <li>password</li> </ol> <p>The XProtect Smart Client dialog has fields for user name and password. Enter the directory with the user name in this format:</p> <ul> <li>DirectoryName\\UserName</li> </ul> How to connect without a directory <p>If no directory is provided, the OnGuard internal directory is used. OnGuard can use special non-alphanumeric characters, control characters, and spaces in directory names. Use of these characters isn't compatible with XProtect. If these types of characters are included in the OnGuard directory, authentication fails.</p> <p>After entering the directory\\user name and password, the XProtect Smart Client validates the credentials with the OnGuard system. If you click Skip this step, the Smart Client opens without using personalized login, and no XProtect Access features are available in the Smart Client. After authentication with OnGuard, Smart Client loads a personalized configuration. The Smart Client displays access control information from the user account that logged in during the personalized configuration login dialog. This includes:</p> <ul> <li>Alarms related to hardware the user has privileges to view</li> <li>Events related to hardware the user has privileges to view</li> <li>Devices in the map element selector that the user has privileges to view</li> </ul>"},{"location":"MCConfig/SupportedCommands/","title":"Supported commands reference","text":"<p>The following are the devices and their supported commands.</p>"},{"location":"MCConfig/SupportedCommands/#readers","title":"Readers:","text":"<ul> <li>Set Mode To Default</li> <li>Set Mode Locked</li> <li>Set Mode Unlocked</li> <li>Set Mode Card Only</li> <li>Set Mode Pin or Card</li> <li>Set Mode Card and Pin</li> <li>Set mode Facility Code</li> </ul> <p>Set Mode</p> <p>Set Mode commands for readers change the authentication mode the reader responds to. For example: a rule can switch readers into unlocked mode during business hours.</p>"},{"location":"MCConfig/SupportedCommands/#reader-inputs","title":"Reader Inputs:","text":"<ul> <li>Mask</li> <li>Unmask</li> </ul>"},{"location":"MCConfig/SupportedCommands/#reader-outputs","title":"Reader Outputs:","text":"<ul> <li>Activate</li> <li>Deactivate</li> <li>Pulse</li> </ul> <p>Inputs &amp; Outputs</p> <p>Reader inputs have a state of masked or unmasked. A masked input doesn't report or save status in the OnGuard system. The masked input also has a \"mask\" icon attached to its own icon on the Smart Client map. Unmask enables status of that input to be reported and saved within OnGuard, and removes the mask icon. Reader outputs are activated, de-activated, and pulsed using the respective commands. The Pulse command activates the output temporarily, then deactivates it. An activated output has a red circle icon attached to it when viewed on the Smart Client map.</p>"},{"location":"MCConfig/SupportedCommands/#doors","title":"Doors:","text":"<ul> <li>Open</li> </ul> <p>Door status animations</p> <p>Doors are opened via the command. When the door opens, the door icon animation displays this status on the Smart Client map. </p>"},{"location":"Mobile/","title":"XProtect Mobile application","text":"<p>XProtect Mobile is a mobile device app that connects to your VMS system. The XProtect Access OnGuard integration adds capability to XProtect Mobile.  Using XProtect Mobile it's possible to receive a push notification from the access control system, view live video related to the notification, and open the door \u2013 all remotely from the app.</p>"},{"location":"Mobile/MobileTab/","title":"Using the access control tab in XProtect Mobile","text":"<ol> <li>Log into the VMS with XProtect Mobile. By default the Views tab appears.</li> <li>Select the Access Control tab. The Access Control tab shows the list of doors available. </li> <li>Filter for specific doors or select a door to view cameras associated to that door or interact with commands available for the selected door. </li> <li>Swipe to switch between cameras when more than one camera is associated to the door.</li> <li>Switch between Doors, Events, and Access Requests.</li> <li>Select an event from the event list to view still images associated to the event and playback video related to the event. </li> <li>Filter the event list to find specific types of events. </li> </ol> <p>Permissions</p> <p>Access requests are visible if the Smart Client profile assigned to the role of the current user can view access requests.</p>"},{"location":"Plan/","title":"Different installation scenarios (explained)","text":"<p>There are different ways to integrate XProtect with the OnGuard access control system.\u00a0This section is a guide to help you figure out which deployment options you should consider.\u00a0</p> <p>Deployment Guide</p> <p>Milestone and LenelS2 have created a technical deployment guide which documents design recommendations, performance thresholds, and architectural guidance within one short document. The OnGuard XProtect Access integration is covered in this deployment guide. Download and read the guide. </p> Installation Scenario Use Case Single System You have a single XProtect system (one event server per system) and a single OnGuard system (one OnGuard database per system). Multiple Single Systems You have multiple single XProtect/OnGuard system pairs.\u00a0The customer just wants each pair to behave independently of each other. XProtect Federated Architecture with OnGuard Enterprise You have a federated XProtect system and an OnGuard Enterprise system that need pairing. The customer needs centralized configuration and alarms. Single system \u2013 Integration Server and OnGuard Server on separate machines There is a need to run the required integration software components on a different machine than the OnGuard Server. XProtect Clustered with OnGuard Clustered You have a XProtect clustered environment connecting to an OnGuard clustered environment."},{"location":"Plan/Clustered/","title":"Milestone XProtect clustered with single clustered OnGuard","text":"<p>When server clusters are used for redundancy, the OnGuard XProtect Access Service requires a separate Integration Server - distributed from both the XProtect and OnGuard server.  Below is the suggested architecture if both XProtect and OnGuard use server clusters:</p> <p>Clustered system design requires a separate integration server</p> <pre><code>flowchart LR\n    A&gt;XProtect Client]:::XPClass&lt;-.-&gt;|login|B[Management Server cluster]:::XPClass\n    subgraph XProtect clustered system\n    B\n    end\n    C[Integration Server]:::XPClass\n    subgraph OnGuard single system clustered\n    D(OnGuard cluster):::XPClass\n    end\n    C&lt;==&gt;|XPA|B\n    D&lt;==&gt;|OpenAccess|C\n    linkStyle 1,2 stroke:#0f0,stroke-width:4px\n    classDef XPClass fill:#efb, stroke:#000, stroke-width:2px</code></pre> XProtect Access Clustered Configuration <p>Before configuring XProtect Access with OnGuard on a system that is using clustered XProtect Management Server Failover which includes a clustered XProtect Event Server, it is required to add all of the clustered Event Server nodes to the Registered Services within XProtect. Please refer to KB 33314 for more details on using XProtect Access with clustering. Refer to KB 34505 for additional information about XProtect in a clustered environment.</p>"},{"location":"Plan/Distributed/","title":"Distributed deployment options","text":"<p>It's possible to have the \u201cintegration\u201d server on a different machine than the XProtect server or the OnGuard server. This option provides segmentation of OnGuard hardware and events to individual XProtect sites, and the distributed scenario helps support OnGuard clustering.</p> <pre><code>flowchart LR\n    A&gt;XProtect Site]:::XPClass &lt;--&gt;|XPA| B[Integration Server]:::XPClass\n    B &lt;--&gt;|HTTPS| C(OnGuard Server):::XPClass\n    classDef XPClass fill:#efb, stroke:#000, stroke-width:2px</code></pre> NOT SUPPORTED - Many to one <p>For design, scaling, and performance reasons, Milestone doesn't support connecting multiple XProtect sites to the same Integration Server instance.</p> <pre><code>flowchart LR\n    A&gt;XProtect Site 1]:::XPClass &lt;--&gt;|XPA| B[Integration Server]:::XPClass\n    C&gt;XProtect Site 2]:::XPClass &lt;--&gt;|XPA| B\n    D&gt;XProtect Site 2]:::XPClass &lt;--&gt;|XPA| B\n    B[Integration Server]:::XPClass &lt;--&gt;|HTTPS| E(OnGuard Server):::XPClass\n    classDef XPClass fill:#f57, stroke:#000, stroke-width:2px</code></pre>"},{"location":"Plan/Federated/","title":"Milestone XProtect Federated Architecture with OnGuard Enterprise","text":"<p>This scenario has many uses. It is recommended for large scale deployments. This is the default scenario when the customer has an Enterprise deployment of OnGuard and wants to integrate with XProtect. Also, it is recommended when the customer wants centralized alarm and configuration management for both systems.</p> <pre><code>flowchart LR\n    A&gt;XProtect Federated Client]:::XPClass &lt;==&gt;|login| B&gt;XProtect Master Site]:::XPClass\n    subgraph XProtect Federated Architecture\n        C&gt;Child site #1]:::XPClass &lt;-.-&gt; |site 2 site link| B&gt;XProtect Master Site]:::XPClass\n        D&gt;Child site #2]:::XPClass &lt;-.-&gt; |site 2 site link| B&gt;XProtect Master Site]:::XPClass\n        E&gt;Child site #3]:::XPClass &lt;-.-&gt; |site 2 site link| B&gt;XProtect Master Site]:::XPClass\n        F&gt;Child site #4]:::XPClass &lt;-.-&gt; |site 2 site link| B&gt;XProtect Master Site]:::XPClass\n    end\n    subgraph OnGuard Enteprise Architecture\n        G(Region #1):::XPClass &lt;-.-&gt;|OnGuard Master/Region link| K(OnGuard Master Site):::XPClass\n        H(Region #2):::XPClass &lt;-.-&gt;|OnGuard Master/Region link| K(OnGuard Master Site):::XPClass\n        I(Region #3):::XPClass &lt;-.-&gt;|OnGuard Master/Region link| K(OnGuard Master Site):::XPClass\n        J(Region #4):::XPClass &lt;-.-&gt;|OnGuard Master/Region link| K(OnGuard Master Site):::XPClass\n    end\n    C &lt;==&gt;|XPA| G(Region #1):::XPClass\n    B &lt;==&gt;|XPA| K(OnGuard Master Site):::XPClass\n    D &lt;==&gt;|XPA| H(Region #2):::XPClass\n    E &lt;==&gt;|XPA| I(Region #3):::XPClass\n    F &lt;==&gt;|XPA| J(Region #4):::XPClass\n    K &lt;==&gt;|login| L(OnGuard Enterprise Client):::XPClass\n    linkStyle 9,10,11,12,13 stroke:#0f0,stroke-width:4px\n    classDef XPClass fill:#efb, stroke:#000, stroke-width:2px</code></pre> <p>Diagram Note</p> <p>Each XPA line in these diagrams represents the HTTP/SignalR connection between the Event Server in XProtect and the OnGuard XProtect Access Service on the OnGuard server. There are some scenarios where the OnGuard XProtect Access Service may not live on the same OnGuard server, see Distributed deployment options for details.</p> <p>Milestone DOES NOT support connecting a single XProtect site to many different OnGuard sites.  We do not recommend running more than one XProtect Access integration per event server, for performance reasons.</p> NOT SUPPORTED - One to Many <pre><code>flowchart LR\n\n    A&gt;Single XProtect]:::XPClass &lt;--&gt;|XPA| B(OnGuard Site 1):::XPClass\n    A &lt;--&gt;|XPA| C(OnGuard Site 2):::XPClass\n    A &lt;--&gt;|XPA| D(OnGuard Site 3):::XPClass\n\n    linkStyle default stroke:#0f0,stroke-width:4px\n    classDef XPClass fill:#f57, stroke:#000, stroke-width:2px</code></pre> <p>Milestone DOES NOT support connecting more than one XProtect site to a single OnGuard site.</p> NOT SUPPORTED - Many to One <pre><code>flowchart RL\n\n    A(Single OnGuard):::XPClass &lt;--&gt;|XPA| B&gt;XProtect Site 1]:::XPClass\n    A &lt;--&gt;|XPA| C&gt;XProtect Site 2]:::XPClass\n    A &lt;--&gt;|XPA| D&gt;XProtect Site 3]:::XPClass\n\n    linkStyle default stroke:#0f0,stroke-width:4px\n    classDef XPClass fill:#f57, stroke:#000, stroke-width:2px</code></pre>"},{"location":"Plan/MultipleSingleSystems/","title":"Multiple single systems","text":"<p>Scaling the default scenario means adding more OnGuard systems and XProtect systems in a 1:1 ratio. The OnGuard and XProtect systems are independent of each other, keeping the OnGuard XProtect Access Service process on the OnGuard machine. The customer is NOT interested in centralized configuration or alarms, the integrated XProtect/OnGuard systems are independent of each other.</p> <p>Integration service (Onguard XProtect Access Service) and OnGuard hosted on the same machine at multiple single site locations.</p> <p>Site #1 - single XProtect and OnGuard integrated system</p> <p><pre><code>flowchart LR\n    a(\"OnGuard XProtect Access MIP Plugin\"):::XPClass -- \"HTTP REST API\" --&gt; b(\"OnGuard XProtect Access Service\"):::XPClass\n    b(\"OnGuard XProtect Access Service\"):::XPClass -- \"SIGNALR Events\" --&gt; a(\"OnGuard XProtect Access MIP Plugin\"):::XPClass\n\n    subgraph \"OnGuard Server\"\n         direction TB\n        subgraph \"Integration Server Process\"\n         b(\"OnGuard XProtect Access Service\"):::XPClass\n        end\n    b(\"OnGuard XProtect Access Service\"):::XPClass &lt;--&gt; c(\"OnGuard OpenAccess Service\"):::XPClass\n    end\n    subgraph \"XProtect Management Server\"\n        direction TB\n        subgraph \"XProtect Event Server Process\"\n        a(\"OnGuard XProtect Access MIP Plugin\"):::XPClass\n        end\n    end \n    classDef XPClass fill:#efb, stroke:#000, stroke-width:2px</code></pre> Site #2 - single XProtect and OnGuard integrated system</p> <pre><code>flowchart LR\n    a(\"OnGuard XProtect Access MIP Plugin\"):::XPClass -- \"HTTP REST API\" --&gt; b(\"OnGuard XProtect Access Service\"):::XPClass\n    b(\"OnGuard XProtect Access Service\"):::XPClass -- \"SIGNALR Events\" --&gt; a(\"OnGuard XProtect Access MIP Plugin\"):::XPClass\n\n    subgraph \"OnGuard Server\"\n         direction TB\n        subgraph \"Integration Server Process\"\n         b(\"OnGuard XProtect Access Service\"):::XPClass\n        end\n    b(\"OnGuard XProtect Access Service\"):::XPClass &lt;--&gt; c(\"OnGuard OpenAccess Service\"):::XPClass\n    end\n    subgraph \"XProtect Management Server\"\n        direction TB\n        subgraph \"XProtect Event Server Process\"\n        a(\"OnGuard XProtect Access MIP Plugin\"):::XPClass\n        end\n    end \n    classDef XPClass fill:#efb, stroke:#000, stroke-width:2px</code></pre> <p>Site #1 and site #2 are independent of each other and not communicating with each other, or commonly managed.  The same is true for both the XProtect and the OnGuard systems in this scenario.</p>"},{"location":"Plan/Redundancy/","title":"Milestone XProtect Management Server redundancy solutions with OnGuard","text":"<p>Both of the XProtect Management Server redundancy solutions are tested and supported to work with the OnGuard XProtect Access integration.</p> <ol> <li>Microsoft Clustered Server solution</li> <li>XProtect Management Server Failover solution</li> </ol> <p>Test results</p> <p>Both XProtect Management Server redundancy solutions offer data resilience and availability for many XProtect system components. As such, integrations which rely on XProtect experience high availability and resilient video access. During failover events, interruption in service still occurs. In particular, the connection to the XProtect Event Server and integration plug-ins or services hosted in the same server environment experience disruption. Tests show the connection to XProtect Access services, and connections to OnGuard re-establish with little or no loss of data, and full system operation restores within minutes.</p> Redundancy configuration details <p>Find more information about these redundancy solutions for XProtect here:</p> <ul> <li>XProtect Management Server Failover</li> <li>Clustering XProtect Management Servers</li> </ul>"},{"location":"Plan/SingleSystemScenario/","title":"Single system scenario","text":"<p>Integration Server Process and OnGuard Server on the same machine.</p> <pre><code>flowchart LR\n    a(\"OnGuard XProtect Access MIP Plugin\"):::XPClass -- \"HTTP REST API\" --&gt; b(\"OnGuard XProtect Access Service\"):::XPClass\n    b(\"OnGuard XProtect Access Service\"):::XPClass -- \"SIGNALR Events\" --&gt; a(\"OnGuard XProtect Access MIP Plugin\"):::XPClass\n\n    subgraph \"OnGuard Server\"\n        direction TB\n        subgraph \"Integration Server Process\"\n        b(\"OnGuard XProtect Access Service\"):::XPClass\n        end\n    b(\"OnGuard XProtect Access Service\"):::XPClass &lt;--&gt; c(\"OnGuard OpenAccess Service\"):::XPClass\n    end\n    subgraph \"XProtect Management Server\"\n        direction TB\n        subgraph \"XProtect Event Server Process\"\n        a(\"OnGuard XProtect Access MIP Plugin\"):::XPClass\n        end\n    end \n    classDef XPClass fill:#efb, stroke:#000, stroke-width:2px</code></pre> <p>For most systems, this is the recommended installation scenario.</p> <ul> <li>First - install the OnGuard XProtect Access Service on the OnGuard server</li> <li>Second - install the OnGuard XProtect Access MipPlugin on the XProtect server</li> </ul> Encrypted communications? <p>All communication and authentication between the OnGuard XProtect Access MIP Plugin and the OnGuard XProtect Access Service can be fully encrypted and secured in both directions. Please read Applying sercure communications between XProtect and the OnGuard XProtect Access Service and Applying secure communications between the OnGuard XProtect Access Service and OpenAccess</p>"},{"location":"Plan/SingleWIntSrv/","title":"Single system with integration server","text":"<p>This is the recommended system design to run the OnGuard XProtect Access Service on a different machine than the OnGuard server.</p> <p>Integration server process (OnGuard XProtect Access Service) hosted on a separate machine. <pre><code>flowchart LR\n    A--&gt;|HTTP Rest API|B\n    B&lt;--&gt;|OpenAccess HTTPS API|C\n    B--&gt;|SIGNALR Events|A\n    subgraph XProtect Management Server\n        subgraph XProtect Event Server\n        A[OnGuard XProtect Access MIP Plugin]:::XPClass\n        end\n    end\n    subgraph Integration Server\n    B[OnGuard XProtect Access Service]:::XPClass\n    end\n    subgraph OnGuard\n    C[OnGuard OpenAccess Services]:::XPClass\n    end\n\n    classDef XPClass fill:#efb, stroke:#000, stroke-width:2px</code></pre></p> Encrypted communications? <p>All communication and authentication between the OnGuard XProtect Access MIP Plugin and the OnGuard XProtect Access Service can be fully encrypted and secured in both directions. Please read Applying sercure communications between XProtect and the OnGuard XProtect Access Service and Applying secure communications between the OnGuard XProtect Access Service and OpenAccess</p>"},{"location":"Prereqs/","title":"Time synchronization","text":"<p>All OnGuard and XProtect servers must be time-synchronized to within a couple of minutes. </p>"},{"location":"Prereqs/CreateDirectory/","title":"Create directory in OnGuard","text":"Warning <p>These instructions are not meant to replace the knowledge of a trained LenelS2 system administrator. They are here to enable the basic setup of an authentication directory and user, so the integration can connect to the OnGuard system.</p> <p>OnGuard Enterprise<p>For an OnGuard Enterprise system, create directories from the master server.</p> </p> <ol> <li>Using the OnGuard System Administration app, go to the Administration menu and select Directories. </li> <li>Choose the directory type, either Windows Local Account or domain user account.</li> </ol> Windows Local Account Domain user account For Windows Local Account support, the single sign-on account MUST be a Windows Local Account. For Domain User Account support, the single sign-on account MUST Allow manual single sign-on as shown below. Other directory types <p>If you are creating a Directory of a type other than Windows Local Accounts (e.g. LDAP, Active Directory), verify the user is a member of the Local Administrators group.</p>"},{"location":"Prereqs/CreateUser/","title":"Create user in OnGuard","text":"Warning <p>These instructions are not meant to replace the knowledge of a trained LenelS2 system administrator. They are here to enable the basic setup of an authentication directory and user so the integration can connect to the OnGuard system.</p> <ol> <li>Go to the Administration menu and select Users\u2026 </li> <li>Add a new user, or modify a user from the list of internal system users. </li> <li>On the General tab Access to this system is disabled should NOT be selected. </li> <li>On the Directory Accounts tab click Link to associate the user to the directory user (or local account user) from the directory created in this topic: Create directory in OnGuard. </li> <li>In the Select Account dialog select the directory from the Directory list. Click Search and select a user in Accounts then click OK. </li> <li>Once selected, the OnGuard user account is linked to the corresponding Directory account. </li> <li>On the Internal Account tab, make sure that the User has internal account option is selected. Next, enter the account credentials. </li> <li>On the Permission Groups tab assign the following permission groups:<ul> <li>System = System Admin</li> <li>Cardholder = Cardholder Admin</li> <li>Monitor = Monitor Admin</li> <li>Reports = Full Access</li> <li>Field/page = View/Edit All Fields </li> </ul> </li> </ol>"},{"location":"Prereqs/DNS/","title":"Event Server DNS name resolution","text":"<p>The server hosting the Milestone XProtect Event Server must have network name resolution. It must resolve the computer name of the OnGuard Server. The OnGuard Server must also resolve the XProtect Event Server.</p>"},{"location":"Prereqs/DotNET/","title":".NET framework for OnGuard","text":"<p>.NET Framework 4.7.2 is a requirement for the integration on the OnGuard server machine (NDP472-KB4054530-x86-x64-AllOS-ENU.exe). This note applies for older OS editions; any OS newer than Windows 10 (April 2018 Update) and Windows Server version 1803 have it installed. Milestone recommends that you use Microsoft Windows Server Editions of the OS.</p>"},{"location":"Prereqs/GenSoftEvents/","title":"Generate software events","text":"<p>In the OnGuard System Administration app, go to the Administration menu, and select System Options:</p> <ol> <li>For OnGuard versions greater than or equal to 7.4 using OpenAccess, check the OpenAccess host and Generate software events checkbox.</li> <li>Set the Linkage Server host to the OnGuard server\u2019s machine name.</li> <li>Set the Message Broker Service host to the OnGuard server\u2019s machine name. </li> </ol>"},{"location":"Prereqs/MSLic/","title":"Milestone XProtect license","text":"<p>The customer must have XProtect Access enabled (1) and the appropriate number of doors (2) in their XProtect SLC. See the Management Client license screen for more details.</p> <p></p>"},{"location":"Prereqs/OGLic/","title":"OnGuard license options -- PLEASE CONSULT CARRIER FOR LICENSING","text":"<p>To enable the integration the following license options are required in the OnGuard license:</p> Connection OnGuard License Options Needed OpenAccess <ul><li>OpenAccess Integration (ITM-MLST-001) enabled with an expiration date</li><li>Partner Integration (IPC-311-MLST01) enabled with an expiration date</li></ul> DataConduIT? <p>For XProtect Access version 3.5 and up, the supported connection mode is OpenAccess. The OnGuard license must have the OpenAccess license options for the integration to function. If you are upgrading from version 3.4 with a DataConduIT license, please refer to Milestone Knowledge Base article 33277.</p>"},{"location":"Prereqs/OGServices/","title":"Required OnGuard services","text":"<p>The following Windows services must run on the OnGuard machine:</p> OnGuard Windows Service Name Description LS Communication Server Required to send and receive status and events between hardware devices and software. LS Event Context Provider Required to send events from the OnGuard system. LS Login Driver Manages the database password for client login for OnGuard. LS Message Broker Required to receive real-time data from the OnGuard system. LS OpenAccess Required to interface the OnGuard system web service-based API OpenAccess (REST/JSON web service). LS Web Event Bridge Required to receive events from the OnGuard system. LS Web Service Required to interface the OnGuard system web-service-based events with OpenAccess (SignalR)."},{"location":"Prereqs/SCProfiles/","title":"Smart Client profile settings explained","text":"<p>If you customize or create new Smart Client profiles in XProtect and the users assigned to those profiles need to receive access request notification pop-up alerts, you need to include the following setting.</p> <ul> <li>Access Control &gt; Show access request notifications = Yes</li> </ul> <p>This is the default setting for all Smart Client profiles. All Smart Client profiles in use need to have this setting configured if system users need to view or interact with access control notifications.</p>"},{"location":"SCFeatures/","title":"Access control workspace explained","text":"<p>The XProtect Access OnGuard integration adds a new workspace, or tab, into the XProtect Smart Client. The Access Control workspace should appear in the Smart Client.</p> <p></p> <p>Use this workspace to search and filter the Events, Doors, and Cardholders categories. Select Events, Doors, or Cardholders to work with the list of events related to that category.</p>"},{"location":"SCFeatures/ACWCardholders/","title":"Access control workspace cardholders","text":"<p>By default, this list displays all cardholders in the system.</p> <ol> <li>Filter for specific cardholders by typing into the search field.</li> <li>Select a cardholder to view their data.</li> <li>Click the View cardholder events button to switch to the Events list - filtered to display events from the chosen cardholder.</li> </ol> <p></p>"},{"location":"SCFeatures/ACWDoors/","title":"Access control workspace doors","text":"<ol> <li>Open the Door list and select the access control hardware to display.</li> <li>Choose the Access control type\u2026, option to open the Select access control types window. <ul> <li>Door is the default option for this list. Use this menu to select servers, panels, and any access control hardware in the system. </li> </ul> </li> <li>Open the All states list to filter hardware by status.</li> <li>Choose the Access control state\u2026, option to open the Select access control states window and select from all available OnGuard hardware states. </li> <li>Open the All doors list and select the Other\u2026, option to open the Select access control elements window.<ul> <li>This window provides a directory of all the OnGuard hardware in the system.</li> </ul> </li> <li>Expand the directory, find the hardware device(s), and add them to the selected list. </li> <li>Select a Door in the list to see video from associated cameras, view door status information, and command buttons available for that door. </li> </ol>"},{"location":"SCFeatures/ACWEvents/","title":"Access control workspace events","text":"<p>To display a list of events, first choose a time range, select a custom time range, or choose to display a live update list of events.</p> <ol> <li>Choose the Live update time range to view a real-time display of access control events. </li> <li>Filter for specific events including custom events and all integrated OnGuard events.</li> <li>Open the All events list and select the Access control event\u2026 option to open the Select access control events window.<ul> <li>Choose a specific OnGuard event from this list. </li> </ul> </li> <li>Filter for specific hardware devices.</li> <li>Click the Access report button to create a PDF file of the events in the current list. <ul> <li>In the Access report window: name the report, choose a destination to save the report, include comments, and select the option to include snapshots. </li> </ul> </li> </ol>"},{"location":"SCFeatures/AccessMonitor/","title":"Access Monitor","text":"<p>The Access Monitor view item displays live status from doors and video from associated cameras in a single view pane in the Smart Client.</p> <ol> <li>Click Setup in the Smart Client and expand the System Overview panel menu. </li> <li>Select the Access Monitor view item and drag it into any available view pane: </li> <li>In the Access Monitor Settings window open the lists to select the door, sources, cameras, events, commands, and the order in which new events appear in the access monitor. </li> </ol> <p>Access Monitor options</p> <p>After choosing a door the access monitor options change, based upon the available cameras, events, and commands. The access monitor view item can go into any available view pane and works in a view alongside all available view items.</p>"},{"location":"SCFeatures/AckOnGuard/","title":"Checking alarm acknowledgment status in OnGuard","text":"<p>When alarms are acknowledged in OnGuard, the alarm is closed, and the associated alarm is also closed in XProtect. If the alarm is acknowledged within XProtect it changes state to in progress both in XProtect and in OnGuard. The status of the alarm in OnGuard changes to reflect the status in XProtect as much as possible. Learn more about how the integration handles alarm acknowledgment here: Alarm acknowledgment explained.</p> <ol> <li>Verify state changes of alarms in the OnGuard system in real time by opening the Alarm Monitoring app from the Start menu.</li> <li>If it isn't automatically opened, click the View Alarms icon to open the Main Alarm Monitor window.</li> <li>Status of OnGuard alarms are displayed in this window in real time. </li> <li>Right click an alarm in this window to acknowledge the alarm. </li> </ol> View Closed Alarm Reports <ol> <li>To view a report of all closed alarms, open the View menu.</li> <li>Select the Reports option.</li> <li>In the Alarm Acknowledgement Reports tab choose a time range and export a report of all acknowledged alarms in the OnGuard system. </li> </ol>"},{"location":"SCFeatures/AckXProtect/","title":"Acknowledge alarms in XProtect","text":"<p>In XProtect operators perform alarm acknowledgment and other alarm status change operations from the XProtect Smart Client.</p> <ol> <li>In the Alarm Manager workspace, or any alarm list view item in the Smart Client, right-click an alarm.</li> <li>Select a new status for the alarm from the shortcut menu. </li> <li>Alarm status synchronizes as much as possible between XProtect and OnGuard.</li> </ol> <p>Alarm acknowledgement explained</p> <p>Learn more about how the integration handles alarm acknowledgment here: Alarm acknowledgment explained.</p>"},{"location":"SCFeatures/AlarmAck/","title":"Alarm acknowledgment explained","text":"<p>Alarm status between XProtect and OnGuard is shared. When alarms change state in XProtect that state is shared with OnGuard. Alarm status is shared in the opposite direction as well \u2013 from OnGuard to XProtect.</p> <p>Alarm states in XProtect and OnGuard are not the same. In XProtect alarms can be new, in progress, on hold, or closed. In OnGuard alarms are new, in progress, or acknowledged.</p> OnGuard Alarm Status XProtect Alarm Status <ul><li>NEW</li></ul> <ul><li>NEW</li></ul> <ul><li>IN PROGRESS</li></ul> <ul><li>IN PROGRESS</li><li>ON HOLD</li></ul> <ul><li>ACKNOWLEDGED</li></ul> <ul><li>CLOSED</li></ul> <p>There are improvements to how alarms change state in the integration.</p> <ul> <li>Acknowledging an alarm in XProtect changes the alarm state to in progress both in XProtect and in OnGuard. </li> <li>In XProtect alarms can change from closed to other states by manually editing the alarm. This isn't allowed in OnGuard. Acknowledged alarms are no longer available to change in OnGuard. If users continue to change the state of a closed/acknowledged alarm in XProtect these changes are not communicated to OnGuard. </li> <li>Alarms in XProtect can return to the new state from any other state, if the alarm is manually edited. This isn't allowed in OnGuard. If a user manually edits an alarm state to new in XProtect from any other state, that change is not made in OnGuard.</li> <li>Although it's possible in XProtect to move a new alarm directly to on hold, this change does not take place in OnGuard, the activity is not even logged in OnGuard. If an alarm is accidentally moved to on hold in XProtect and instead it needs to move to in progress in both OnGuard and XProtect, it can be moved back to in progress, only by manually editing the status in XProtect.</li> <li>Once an alarm is in progress in OnGuard it can be \"updated\" with notes, however its status in XProtect will remain in progress, until it is acknowledged/closed. Status changes made in XProtect from in progress to on hold do not impact the status in OnGuard.</li> </ul> Revert Alarm behavior to old versions <p>It's possible to change the alarm acknowledgment behavior of the integration to match previous versions (older than 4.2). How to make this change, and what this behavior means is documented here: Changing alarm acknowledgment behavior.</p>"},{"location":"SCFeatures/MapIconRef/","title":"Map icon hardware and status details","text":"<p>There are several different access control map icons available on the standard Smart Client map. Each different type of icon represents a specific hardware device. Visual indicators appear on these hardware icons to display the current status of the devices they represent. Many different types of hardware and status options are listed below.</p> <p></p> <p>The map feature of the XProtect Smart Client has many capabilities, please refer to the maps section of the Smart Client user guide.</p> Red ring <p>Controllers send status information to XProtect Access to support display of tamper alarms on those device icons. For supported controllers, a red alarm status ring appears on the icon when it's in a tampered state. When the controller physically returns to a safe state, the alarm status disappears from the icon.</p> <p>If you want to verify the list of available device icons and statuses in your XProtect Access system follow this process:</p> <ol> <li>Go to the Tools menu in the XProtect Management Client and select Options.</li> <li>On the Access Control Settings tab of the Options window choose to Show development property panel.</li> <li>Close and re-open the Management Client.</li> <li>Go to the DEV:Category Mapping tab of the XProtect Access instance.</li> </ol>"},{"location":"SCFeatures/Maps/","title":"Maps","text":"<p>It's possible to place doors, readers, inputs, outputs, panels, and OnGuard server(s) on an existing Smart Client map. The map icons can display hardware status and execute commands.</p> <ol> <li>With the Smart Client in setup mode, a Tools window appears in the view pane.</li> <li>From this window, select the Add Access Control icon: </li> <li>The Element Selector window appears. </li> <li>Type the name of a hardware device into the filter to find a device or expand the servers and panels to find all available hardware icons in the system. </li> <li>Drag the chosen icon onto the map.</li> <li>During normal operations, it's possible to right-click any of these icons to execute the commands from the shortcut menu. </li> <li>Right click the device icon and select Status Details from the shortcut menu to view more information. The pop-up window displays the device status information in the Value field. </li> </ol> <p>New map icons</p> <p>In versions 4.2 and newer of the integration, the map icons include more status options and hardware items. If you want to know the possible hardware items and status options refer to the Map icon hardware and status details topic.</p>"},{"location":"SCFeatures/OGWebLink/","title":"OnGuard web admin link","text":"<p>If a web portal link was added to the General Settings of the XProtect Access OnGuard integration within the XProtect Management Client, then the Access control administration link in the Access Control workspace of the XProtect Smart Client is active.</p> <p></p> <ol> <li>Click the Access control administration link to view the OnGuard Admin button. </li> <li>Select the OnGuard Admin button to launch the OnGuard web administration portal. </li> </ol> <p>Multiple OnGuard Systems</p> <p>If multiple XProtect Access systems integrate with the same XProtect VMS it's possible to have more than one button in the Smart Client after selecting the Access control administration link.</p>"},{"location":"SCFeatures/OldAckBehavior/","title":"Changing alarm acknowledgment behavior","text":"<p>Edit the PluginSettings.json file to change the behavior of the alarm acknowledgment between OnGuard and XProtect.</p> <p>The section of the .json file to edit looks like this:</p> JSON<pre><code>\"AlarmAcknowledgmentSettings\": {\n/*Set this property to 'true' if you want to use the pre-4.2 sync behavior where only the acknowledged/closed alarm states are synchronized.*/\n\"OnlySynchronizeAlarmClosed\": false\n}\n</code></pre> <p>Change the false to true, save the file and restart the services.</p> Old alarm acknowledgement behavior explained <p>In older versions of the integration alarm status between XProtect and OnGuard was shared in a limited way. When alarms were closed in XProtect that state was shared with OnGuard. In the OnGuard system the same alarm would be acknowledged. Alarm status was shared in the opposite direction as well \u2013 from OnGuard to XProtect.</p> <p>Possible alarm states in XProtect and OnGuard weren't the same. In XProtect alarms could be new, acknowledged, set on hold, or closed. In OnGuard alarms were either active or acknowledged. For the XProtect Access OnGuard integration, acknowledged alarms in OnGuard were the same as closed alarms in XProtect. All other alarm states in XProtect were active alarms in OnGuard.</p> OnGuard Alarm Status XProtect Alarm Status <ul><li>ACTIVE</li></ul> <ul><li>NEW</li><li>ACKNOWLEDGED &gt; IN PROGRESS</li><li>ON HOLD</li></ul> <ul><li>ACKNOWLEDGED</li></ul> <ul><li>CLOSED</li></ul> <p>When alarms were acknowledged in OnGuard, the alarm was closed, and the associated alarm was also closed in XProtect. If the alarm was acknowledged within XProtect it would not change status in OnGuard. The status of the alarm in OnGuard would change when the alarm was closed in XProtect.</p>"},{"location":"SCFeatures/OverlayButtons/","title":"Overlay buttons &amp; commands","text":"<p>Overlay buttons are software buttons capable of being added to video panes in the Smart Client. Anything triggered by a command, can be triggered manually by an overlay button. </p> <ol> <li>When the Smart Client is in setup mode, there is an Overlay Buttons panel on the left side of the client.</li> <li>Select the Access Control icon. </li> <li>Expand the Access Control icon to find all the doors and readers, panels, and the connected inputs and outputs in the system. </li> <li>Select a command from the list and drag it onto the view pane. </li> <li>The output commands include activate and deactivate. Once the button is visible on a camera view pane, and the Smart Client is in setup mode, it is possible to re-size, move, and rename the overlay button. </li> </ol>"},{"location":"SCFeatures/SCACOptions/","title":"Smart Client access control options","text":"<ol> <li>In the upper right corner of the Smart Client is the Settings and more menu. <ul> <li>Click this icon and choose the Settings option to enter the Smart Client Settings window.</li> </ul> </li> <li>Select the Access Control menu in the Settings window. </li> <li>Choose to show or block access request notifications in the Smart Client.</li> </ol>"},{"location":"Tech/","title":"Software version compatibility","text":"<p>Integration with OnGuard access control system is supported for all XProtect VMS products that support MIP integrations. To find  a list of supported versions of the following software components, read the most recent compatibility information.</p> <ul> <li>OnGuard access control software</li> <li>XProtect video mangement software</li> <li>OnGuard XProtect Access integration software </li> </ul> <p>Recommendations</p> <p>Please verify the version of OnGuard  is compatible. Milestone recommends the latest versions of both OnGuard and XProtect.</p>"},{"location":"Tech/ConfigSegs/","title":"Configuring segments within OnGuard","text":"Warning <p>The following process shows where the information about existing segments is found within an OnGuard system. Please consult with your LenelS2 representative before adding segments to an operational OnGuard system.</p> <ol> <li>Go to the Segments sub-menu in the Administration menu of the OnGuard System Administration application.</li> <li>The Segment Options tab contains options to enable segmentation.      </li> <li>The Segments tab contains the segments configured within OnGuard.      </li> </ol>"},{"location":"Tech/FIPS/","title":"FIPS-140-2 compatibility","text":"<p>This integration is compatible with operating systems that are running in FIPS mode, it is fully tested and supported in these environments. This integration is not officially FIPS-140-2 compliant. XProtect and OnGuard are individually both FIPS-140-2 compliant.</p>"},{"location":"Tech/HardwareSupport/","title":"Hardware support","text":"<p>The following OnGuard panels are tested and supported by Milestone Technical Support. More hardware models are compatible.</p> Panel Model Description LNL-500 Intelligent System Controller LNL-1100 Input Control Module LNL-1200 Output Control Module LNL-1300 Single Reader Interface Module LNL-1320 Dual Reader Interface Module LNL-2210 Intelligent Single Door Controller LNL-2220 Intelligent Dual Reader Controller LNL-3300 Intelligent System Controller LNL-4420 Advanced Dual Reader Controller"},{"location":"Tech/KnownLimitations/","title":"Limitations","text":"<ul> <li> <p>OnGuard doesn\u2019t model doors; instead it models readers. But XProtect Access requires doors. The OnGuard plugin creates virtual doors based on reader properties (i.e. panel id, panel address, reader number, etc). The virtual door names are taken from the first reader that has a non-empty display name. If that reader is named \u201creader 1\u201d, that\u2019s what the door is named. This may not be intuitive when viewed in the XProtect Management Client or Smart Client applications\u2019 hardware hierarchy</p> </li> <li> <p>The XProtect Access instance in the Management Client can fail to load after the Event Server starts or is restarted if the OnGuard XProtect Access Service on the OnGuard server isn't started and running. Symptoms of this issue include:</p> <ul> <li>Existing XProtect Access instance disappears from Management Client</li> <li>Creation of new XProtect Access instance is not allowed</li> <li>NullReferenceException log entries appear in the Event Server log file </li> </ul> </li> </ul>"},{"location":"Tech/OnGuardCerts/","title":"Applying secure communications between the OnGuard XProtect Access Service and OpenAccess","text":"<p>In versions 4.2 and higher of the XProtect Access OnGuard integration, encrypted communication is fully supported. This process shows the steps required to extract and distribute the required certificates and configure the solution to enable secure communications between the OnGuard XProtect Access Service and OpenAccess.</p> <p>Standalone server</p> <p>The process below isn't needed when the OnGuard XProtect Access Service runs on the OnGuard server that hosts the OpenAccess service. In integrated systems where the OnGuard XProtect Access Service and the OpenAccess service are co-located encrypted communication can be enabled with no extra configuration.</p> <ol> <li>Go to the OpenAccess server, open PowerShell and run the following script to extract the CA certificate.     PowerShell<pre><code>$cert = Get-ChildItem 'Cert:\\LocalMachine\\LS Certificate Store' |`\nWhere-Object{$_.Subject -like \"*cn=$ENV:COMPUTERNAME*\"}\nif ($cert) {$match = Select-String \"CN=(.*?),\"`\n-InputObject $cert.Issuer\n$issuer = $match.Matches.groups[1].Value\n$RootCert = Get-ChildItem 'Cert:\\LocalMachine\\Root'`\n|Where-Object{$_.Subject -like \"CN=$issuer*\"}\nif ($RootCert) {Export-Certificate -Cert $RootCert -FilePath \".\\LenelCert.cer\"}`\nelse{write-host \"Could not find $Issuer Certificate.\" -foregroundcolor Red}}`\nelse{write-host \"Could not find $env:Computername Certificate in LS Certificate Store.\"`\n-foregroundcolor Red}\n</code></pre></li> <li>By default the script exports the extracted root certificate to the current directory. Copy the certificate and move it to the OnGuard XProtect Access Service server.</li> <li>On the OnGuard XProtect Access Service host server right-click the certificate and select Install Certificate to begin the certificate installation wizard.</li> <li>Choose to place the certificate in the Store Location of the Local Machine.</li> <li>Browse and import the certificate in to the Trusted Root Certification Authorities folder.\\</li> <li>Complete the wizard.</li> <li>Now apply encryption for the OnGuard XProtect Access instance in the XProtect Management Client. This process enables use of OpenAccess - SSL Certificate Validation, option B below. </li> </ol>"},{"location":"Tech/PluginSettings.JSON/","title":"Working with the PluginSettings.json configuration file","text":"<p>The OnGuard XProtect Access Integration uses a .json file to control the configuration options for cardholder and visitor search, and alarm acknowledgment. This PluginSettings.json file is on the OnGuard server or the host of the OnGuard XProtect Access Service. The file location should be:</p> PowerShell<pre><code>C:\\ProgramData\\VideoOS\\VideoOS.OnGuard.XPA.Service\\Translators\\OnGuard\\PluginSettings.json\n</code></pre> <p>Edit this file to change the data displayed for cardholders in the Smart Client, and change the display order for cardholder names. For example, the first name, middle name, and last name can appear in any order. It's also possible to change the data displayed for visitors. Lastly, the PluginSettings.json file can enable or disable the default alarm acknowledgment behavior.</p> <p>After editing and saving the .json file, changes take effect after the next restart of the OnGuard XProtect Access Service and the XProtect Event Server. Follow this process to edit the file:</p> <ol> <li>Complete the first cardholder search or receive the first access control event</li> <li>.json file is created with the default configuration.</li> <li>Edit the .json file to meet the new requirements.</li> <li>Restart the OnGuard XProtect Access Service.</li> <li>Restart the XProtect Event Server</li> </ol> Upgrading versions? <p>Upgrades from older versions of the OnGuard XProtect Access integration to versions 4.2 or newer may not automatically receive a fully detailed PluginSettings.json file. Delete the file, restart the OnGuard XProtect Access Service, send an event or perform a cardholder search.</p>"},{"location":"Tech/SSOExplained/","title":"XProtect Access and SSO authentication (explained)","text":"<p>XProtect single sign-on (SSO) doesn't delegate SSO to the OnGuard system. XProtect SSO uses the logged in Windows user, and it can't automatically present that same user to OnGuard for authentication. The personalized login feature of XProtect Access is how XProtect presents unique credentials for authentication with OnGuard.</p> <p>These personalized login credentials can match a user with SSO in OnGuard. They can even be the same user logged into Windows who is launching the Smart Client. The credentials must be entered at the first login of the Smart Client, and re-entered if the credentials are changed in OnGuard. Then a user can log into Windows, launch the Smart Client, which automatically authenticates with XProtect via SSO. At this point the stored credentials for the personalized login user that matches the XProtect user are presented to OnGuard and the OnGuard user's configuration is loaded into the Smart Client. This can all be done without manually presenting any credentials to XProtect or OnGuard.</p> <pre><code>flowchart LR\n    A[Windows User]:::XPClass--&gt;|open Smart Client|B[SSO into XProtect]:::XPClass\n    subgraph Launching customized Smart Client\n    B--&gt;C[personalized login]:::XPClass\n    C&lt;--&gt;|stored SSO user credentials|D[OnGuard]:::XPClass\n    end\n    E[custom Smart Client ready!]:::XPClass\n    C--&gt;E\n    classDef XPClass fill:#efb, stroke:#000, stroke-width:2px</code></pre> <p>This is the closest to a true SSO user experience that the XProtect Access integration offers. It requires using the personalized login feature. If this feature isn't used, all authentication to OnGuard from XProtect Access uses the same user credentials that the OnGuard XProtect Access Service uses to refresh and fetch the configuration from OnGuard. To use this partial SSO user experience with customized privileges, it's important to link XProtect users and roles directly to the appropriate SSO users within OnGuard.</p>"},{"location":"Tech/Scalability/","title":"Scalability","text":"<p>This section details the size of the test system at the LenelS2 certification labs and lists the maximum documented performance.</p> <p>The software interface between Milestone and OnGuard is optimized for throughput of events and system status messages. Server components and computer hardware resources can still limit total throughput.</p> Device Type Count Panel 1925 Door 1024 Reader 1028 IO Module 14 Input 2074 Output 2055 Cardholders 400,000 Event Events/sec OpenAccess 100 OpenAccess - Peak 300+"},{"location":"Tech/SecComExp/","title":"Secure communication explained","text":"<p>XProtect Access\u00a0integrations can be  configured  to use encrypted communications. The XProtect Access integration with OnGuard can encrypt communications between the XProtect Access service and the XProtect Event Server, and between the XProtect Access service and OpenAccess service. </p> Certificate Types <p>Please note: the instructions in this document are for generating self-signed certificates. It's possible to get certificates from a trusted third-party provider. For more information please read the XProtect VMS certificates guide.</p> <p>The process of securing communications between OnGuard and XProtect should start after the integration has been installed and configured. There are two different processes required.</p> <pre><code>flowchart LR\n    A&gt;XProtect Server]:::XPClass &lt;--&gt;|#1 HTTPS| B[Integration Server]:::XPClass\n    B&lt;--&gt;|#2 HTTPS| C(OnGuard Server):::XPClass \n    linkStyle default stroke:#0f0,stroke-width:4px\n    classDef XPClass fill:#efb, stroke:#000, stroke-width:2px </code></pre> <ol> <li>Certificate generation, distribution, and configuration supporting secure communications between XProtect and the OnGuard XProtect Access Service.</li> <li>Certificate extraction, distribution, and configuration supporting secure communications between OpenAccess and the OnGuard XProtect Access Service. This process (#2) is required when the OnGuard XProtect Access Service isn't installed on the OpenAccess host machine. </li> </ol>"},{"location":"Tech/SegmentsExplained/","title":"OnGuard segments explained","text":"<p>Personalized login can control which devices, events, and alarms users can view in the Smart Client when integrated with segmented OnGuard systems. A segmented OnGuard system uses logical groupings, known as segments, to define which access panels, readers, cardholders, and users work together.</p> Warning <p>Creating a segmented system within OnGuard shouldn't be a part of installing the XProtect Access OnGuard integration. It's recommended to consult with an authorized OnGuard representative before configuring segments.</p> <p>For example, an organization with facilities in many locations can use segments within their OnGuard system so users have access to view and manage the devices at the facilities relevant to their job.</p> <p>Illustrated below is an organization with three sites, a head quarters, site 1, and site 2.</p> <p></p> <p>Using segments, the guard user at site 1 can see readers, panels, and cardholders from segment 1, and the guard user from site 2 can see the devices and information from segment 2. The manager can see all devices and information, since they're in the default \"All Segments\" segment.</p> <p></p>"},{"location":"Tech/UserSegs/","title":"Mapping OnGuard users to segments","text":"<ol> <li>Go to the Users sub-menu in the Administration menu of the OnGuard System Administration application.</li> <li>Click Modify.</li> <li>Select the Segment Access sub-tab.</li> <li>In the Segment listing window, select the segment(s) the user has access to.      </li> <li>Click OK to save the changes.</li> </ol> Mapping domain users <p>It's recommended to map users logically from your domain, to XProtect, to OnGuard and to their segment. This lets SSO in XProtect work with the personalized log-in feature, and with segments within OnGuard, to simplify the log-in experience, while also customizing and controlling the integrated Smart Client.</p> <p>You can map OnGuard users to a domain user within XProtect in the Directory Accounts sub-tab of the Users sub-menu of the Administration menu in the OnGuard System Administration application.</p> <p></p>"},{"location":"Tech/XProtectCerts/","title":"Applying secure communications between XProtect and the OnGuard XProtect Access Service","text":"<p>In versions 4.2 and higher of the XProtect Access OnGuard integration, there is a tool built into the XProtect Access service to help users manage certificates. This process shows the steps required to generate, distribute, and configure the solution to secure communications between XProtect and the OnGuard XProtect Access Service.</p> Certificate Types <p>The process included below is for self-signed certificates. If you are using a third party certificate, from a commercial certificate provider, please skip ahead to step number ten below. Refer to the XProtect Certificate Guide for any questions on dealing with certificates.</p> <ol> <li>On a server with restricted access, open PowerShell as an administrator and run the script below, to create a CA certificate. PowerShell<pre><code># Run this script once, to create a certificate that can sign multiple server SSL certificates\n# Private certificate for signing other certificates (in certificate store)\n$ca_certificate = New-SelfSignedCertificate -CertStoreLocation cert:\\CurrentUser\\My -DnsName 'VMS Certificate Authority' -KeyusageProperty All `\n-KeyUsage CertSign, CRLSign, DigitalSignature -FriendlyName 'VMS CA Certificate' `\n-TextExtension @(\"2.5.29.19={critical}{text}ca=TRUE\")\n# Thumbprint of private certificate used for signing other certificates\nSet-Content -Path \"$PSScriptRoot\\ca_thumbprint.txt\" -Value $ca_certificate.Thumbprint\n# Public CA certificate to trust (Third-Party Root Certification Authorities)\nExport-Certificate -Cert \"Cert:\\CurrentUser\\My\\$($ca_certificate.Thumbprint)\" -FilePath \"$PSScriptRoot\\root-authority-public.cer\"\n</code></pre> </li> <li>By default the script places the new root certificate in the C: file location. Move the certificate to the XProtect server.</li> <li>On the XProtect server right-click the certificate and select Install Certificate to begin the certificate installation wizard.</li> <li>Choose to place the certificate in the Store Location of the Local Machine.</li> <li>Browse and import the certificate in to the Trusted Root Certification Authorities folder.</li> <li>Complete the wizard.</li> <li>Go back to the server with restricted access where you generated the root certificate, open PowerShell and enter the script below, to generate a new client certificate to install on the server hosting the OnGuard XProtect Access Service. PowerShell<pre><code># Run this script once for each server for which an SSL certificate is needed.\n# Certificate should be executed on the single computer where the CA certificate is located.\n# The created server SSL certificate should then be moved to the server and imported in the\n# certificate store there.\n# After importing the certificate, allow access to the private key of the certificate for\n# the service user(s) of the services that must use the certificate.\n# Load CA certificate from store (thumbprint must be in ca_thumbprint.txt)\n$ca_thumbprint = Get-Content -Path \"$PSScriptRoot\\ca_thumbprint.txt\"\n$ca_certificate = (Get-ChildItem -Path cert:\\CurrentUser\\My\\$ca_thumbprint)\n# Prompt user for DNS names to include in certificate\n$dnsNames = Read-Host 'DNS names for server SSL certificate (delimited by space - 1st entry is also subject of certificate)'\n$dnsNamesArray = @($dnsNames -Split ' ' | foreach { $_.Trim() } | where { $_ })\nif ($dnsNamesArray.Length -eq 0) {\nWrite-Host -ForegroundColor Red 'At least one dns name should be specified'\nexit\n}\n$subjectName = $dnsNamesArray[0]\n$dnsEntries = ($dnsNamesArray | foreach { \"DNS=$_\" }) -Join '&amp;'\n# Optionally allow the user to type in a list of IP addresses to put in the certificate\n$ipAddresses = Read-Host 'IP addresses for server SSL certificate (delemited by space)'\n$ipAddressesArray = @($ipAddresses -Split ' ' | foreach { $_.Trim() } | where { $_ })\nif ($ipAddressesArray.Length -gt 0) {\n$ipEntries = ($ipAddressesArray | foreach { \"IPAddress=$_\" }) -Join '&amp;'\n$dnsEntries = \"$dnsEntries&amp;$ipEntries\"\n}\n# Build final dns entries string (e.g. \"2.5.29.17={text}DNS=myhost&amp;DNS=myhost.domain.com&amp;IPAddress=10.0.0.103\")\n$dnsEntries = \"2.5.29.17={text}$dnsEntries\"\n# The only required purpose of the sertificate is \"Server Authentication\"\n$serverAuthentication = '2.5.29.37={critical}{text}1.3.6.1.5.5.7.3.1'\n# Now - create the server SSL certificate\n$certificate = New-SelfSignedCertificate -CertStoreLocation Cert:\\CurrentUser\\My -Subject $subjectName -Signer $ca_certificate `\n-FriendlyName 'VMS SSL Certificate' -TextExtension @($dnsEntries, $serverAuthentication)\n# Export certificate to disk - protect with a password\n$password = Read-Host -AsSecureString \"Server SSL certificate password\"\nExport-PfxCertificate -Cert \"Cert:\\CurrentUser\\My\\$($certificate.Thumbprint)\" -FilePath \"$PSScriptRoot\\$subjectName.pfx\" -Password $password\n# Delete the server SSL certificate from the local certificate store\n$certificate | Remove-Item\n</code></pre></li> <li>The script requires input: the DNS name of the server hosting the OnGuard XProtect Access Service, the IP address of the server, and a certificate password of your own choosing - enter this information and complete the script.</li> <li>By default the script generates the certificate at the C: file location. Copy the file and move it to the server hosting the OnGuard XProtect Access Service. </li> <li>Go to the server hosting the OnGuard XProtect Access Service and run the certificates snap-in for the local machine. Right-click the Certificate store within the Personal folder and choose to Import a new certificate. </li> <li>Import the certificate into the store of the local machine. Choose the certificate file that you copied to the local server. Enter the password chosen during the script. Browse to the personal folder of the certificate store to choose that as the location for the certificate. Complete the import wizard.</li> <li>Open the OnGuard XProtect Access Service service tray icon and choose the certificate to use. It should match the hostname of the OnGuard server. The service restarts once the configuration is saved.</li> <li>Now apply encryption for the OnGuard XProtect Access instance in the XProtect Management Client. There are three options to use for secured communication for the integration. This process enables use of XProtect Access  Service - SSL Certificate Validation, option A below. </li> </ol>"},{"location":"Tray/","title":"Service tray icon (explained)","text":"<p>The OnGuard XProtect Access Service, that runs on the OnGuard server has a service tray icon with a shortcut menu used for viewing status of the service, managing certificates, launching the log viewer, and starting and stopping the service. Right-click the OnGuard XProtect Access Service service tray icon to view the shortcut menu.</p> <p></p>"},{"location":"Tray/LogViewer/","title":"Using the log viewer application","text":"After integration upgrades <p>When upgrading the integration, all log levels configured in a non-default level of detail (not Info) are reset to \"Info\" after the upgrade. Please confirm and reconfigure the log level to the desired setting after the upgrade is complete.</p> <ol> <li>Choose the View logs option from the shortcut menu of the service tray icon to launch the log viewer. </li> <li> <p>All available log files are in the Logs List. Adjust the detail level of the log using the list to the left of the Open button. Once you have chosen the level of detail click the Apply button to change the log level. The success dialog window pops up when the change is applied.</p> <p>Log level explained</p> <p>The available log levels are Trace, Debug, Info (default), Warn, Error, and Fatal. Trace shows the highest level of detail, Fatal shows the least amount of detail.</p> </li> <li> <p>Click the Open button to launch a new window used to search through the individual log file. </p> <ul> <li>Type in the text field at the top of the menu and hit enter or click the magnifying glass icon to start a text search. Use the First, Prev, Next, and Last buttons in the top right to navigate the search results.</li> <li>The Clear Screen button empties the main text display window, and the Reload button resets the current log file after a search. If the log file is large and takes time to load, the Load Progress graph at the bottom left displays the status of the load operation.</li> <li>Use the Filter Options menu to choose which types of log messages to display.</li> <li>The Word Wrap and Auto scroll options control the appearance and real-time behavior of the main text display window.</li> </ul> </li> <li> <p>Click the Open Log File... button to launch a file explorer menu set to the local log file location.</p> <p>Log location</p> <p>The default location of the log files is <code>C:\\ProgramData\\VideoOS\\VideoOS.OnGuard.XPA.Service\\logs</code></p> </li> <li> <p>Click the About button for version information and online access to Milestone support resources.</p> </li> <li>Click the Color Configuration button to open the Color Configuration menu to create a custom color scheme for the log reader. Custom color schemes are saved, exported, and imported with this menu. The Default button removes any customized configurations and applies the default settings. </li> </ol>"},{"location":"Tray/SelectCert/","title":"Using the Select Certificate menu","text":"<ol> <li>From the server hosting the OnGuard XProtect Access Service right-click the service tray icon for the OnGuard XProtect Access Service and choose the Select Certificate... option.</li> <li>This opens the Select Certificate dialog. Initially, the Use default self signed certificate option is selected. </li> <li> <p>The option is also available to choose any other certificate. Choose the Use certificate from the list below option to select any certificate from the local machine's personal certificate store.</p> Empty certificate list <p>If there are no certificates available in the list, please refer to Secure communications explained and read about creating compatible certificates.</p> </li> <li> <p>The Certificate properties... button launches a properties menu for the chosen certificate.</p> </li> </ol>"},{"location":"Troubleshooting/","title":"Basic support checklist","text":"<p>For issues not covered in this guide, please contact Milestone Support at support@milestone.us, or by phone at 503-350-1100.</p> <p>Simple items can lead to support calls if overlooked. Below is a short list of those items. First are the items to check on the XProtect Access system, followed by a list of things to verify on the OnGuard system. For both, make sure the versions of the OnGuard system and the XProtect system are supported.</p>"},{"location":"Troubleshooting/#xprotect-access","title":"XProtect Access","text":"Start Here <ul> <li>Check that the doors in XProtect Access are licensed.</li> <li>Check that the doors in XProtect Access are enabled.</li> <li>Verify the XProtect Access Service is running. <ul> <li>Check the service tray icon on the server where the XPA service is installed to verify. </li> </ul> </li> <li>Make sure the Event Server connection to the XPA service is connected.</li> <li>Double check that the credentials used for the OpenAccess user and password fields are correct.</li> </ul> Events, alarms and status problems <ul> <li>Verify all required doors and other devices from the OnGuard system are added to the XProtect Access system.<ul> <li>As devices change over time, it's suggested to refresh the configuration from the General Settings tab.</li> </ul> </li> <li>Check that events are displayed in the Smart Client access control workspace Events List.<ul> <li>Make sure there are no filters applied which might be changing the results.</li> </ul> </li> <li>Check that events are being displayed in the Management Client when the Live Events dev tab is displayed</li> <li>Match the Source of events appearing in the Smart Client access control workspace to any Alarms defined in the Alarm Definition menu of the Management Client.<ul> <li>Smart Client event source location: </li> <li>Management Client Alarm Definition source location: </li> </ul> </li> <li>Open the log viewer application and check the following logs to verify your events are received by the XProtect Access Service:<ul> <li>XPA Translator - Event Manager Logs<ul> <li>Change the log level to Debug and Apply the change. Send some events into the system and then Open the log file. </li> </ul> </li> </ul> </li> <li>Open the MIP Plugin logs at this location to verify that the events are received by the Event Server:<ul> <li>C:\\ProgramData\\VideoOS\\VideoOS.OnGuard.XPA.MipPlugin\\VideoOS.Event.Server\\logs</li> </ul> </li> </ul> <p>Milestone Diagnostics Tool</p> <p>In order to have all of the log information that might be required to help troubleshoot event issues, it is recommended to use the Milestone Diagnostics Tool. Read about how to use this tool, and how to gather log data, here.</p>"},{"location":"Troubleshooting/#onguard","title":"OnGuard","text":"<ul> <li>Check that the required OnGuard services are running.</li> <li>Check SQL server configuration for the OnGuard system. This process is detailed in a knowledge base article here.<ul> <li>This step requires running a SQL query using SQL Server Management Studio and potentially modifying the configuration.</li> </ul> </li> </ul> <p>Advanced</p> <p>If all of these attempts to fix event communication fail contact Milestone technical support. There are additional tools, such as the OnGuard Event Subscriber tool, which can be used to gather all event communication on an OnGuard system and output it to a text file for further troubleshooting. This tool is only available through support.</p>"},{"location":"Troubleshooting/AllElse/","title":"All other support issues","text":"<p>For issues not covered in this guide, please contact Milestone Support at <code>support@milestone.us</code>, or by phone at 503-350-1100.</p>"},{"location":"Troubleshooting/CardholderModify/","title":"Cardholder search data fields are missing, or out of order","text":"<p>The OnGuard XProtect Access Integration uses a default list of cardholder data fields when searching for cardholders. Edit the PluginSettings.json file to change which data is available, and the order of the cardholder name fields.</p> <p>The default list of cardholder data fields:</p> .JSON file data field text Description LASTNAME Cardholders last name FIRSTNAME Cardholders first name MIDNAME Cardholders middle name ADDR1 Street address on file for cardholder CITY City on file for cardholder ZIP Zip code or postal code on file for cardholder PHONE Phone number on file for cardholder OPHONE Additional phone number on file for cardholder <p>Edit the list in this .json file to add new data fields, remove existing data fields and change the order of the data fields. \"CardholderSearchFields\" defines the data types available, and \"CardholderDisplayName\" sets the order of data display. If the list in the .json file is empty, then the complete range of search-able fields is used. The file location should be:</p> <p><code>C:\\ProgramData\\VideoOS\\VideoOS.OnGuard.XPA.Service\\Translators\\OnGuard\\PluginSettings.json</code></p> <p>The section of the .json file to edit in order to change the cardholder settings looks like this:</p> JSON<pre><code> \u201cCredentialHolderSettings\u201d: {\n/*The Onguard Cardholder fields used when searching for Credential Holders in XProtect. Leave empty to use all available searchable string fields in OnGuard.*/\n\u201cCardholderSearchFields\u201d: {\n\u201cLASTNAME\u201d,\n\u201cFIRSTNAME\u201d,\n\u201cMIDNAME\u201d,\n\u201cADDR1\u201d,\n\u201cCITY\u201d,\n\u201cZIP\u201d,\n\u201cPHONE\u201d,\n\u201cOPHONE\u201d\n}\n/*The Onguard Cardholder display name field is for changing the cardholder display name. Available fields are FIRSTNAME, MIDNAME, LASTNAME, and any additional Card Holder properties.*/,\n\"CardholderDisplayName\": {\n\"FIRSTNAME\",\n\"MIDNAME\",\n\"LASTNAME\",\n}\n}\n</code></pre> <p>After editing and saving the .json file, changes take effect after the next restart of the OnGuard XProtect Access Service and the XProtect Event Server.</p> After integration version upgrades <p>Upgrades from previous versions of the OnGuard XProtect Access integration may not automatically receive a fully detailed PluginSettings.json file. If the .json file is not available, it can be recreated with the default search fields and display names the next time the OnGuard XProtect Access Service is restarted and a new search is performed. After the default file is created, it's recommended to edit the file to obtain the correct combination of search fields and name order for your installation.</p>"},{"location":"Troubleshooting/DevTabs/","title":"XProtect Access developer tabs (explained)","text":"<p>Hidden tabs are built into the XProtect Access instance in the Management Client. These tabs contain helpful information when troubleshooting.</p> <p></p>"},{"location":"Troubleshooting/DevTabsRef/","title":"Developer tabs (reference)","text":"<p>Below is a description of how to use each of the hidden developer tabs available within the XProtect Access instance.</p> DEV:InfoDEV:Item States &amp; CommandsDEV: Category MappingDEV: Camera MappingDEV: Live EventsDEV: Live State ChangesDEV: Live Credential Holder Changes Tab Name Description DEV: Info This tab has the entire hierarchy of servers, devices, statuses, commands, and events in the system. Selecting an individual object allows for identification of any properties associated to it. <p></p> Tab Name Description DEV: Item States &amp; Commands This tab shows all devices and servers in the system. Select a device or server to view all associated commands and possible statuses. The current state of the device or server is displayed in bold. <p></p> Tab Name Description DEV: Category Mapping The Category Mapping tab is primarily used for debugging during development making sure that the Events, Commands, States, Servers, and Devices are mapped correctly between OnGuard and XProtect. <p></p> Tab Name Description DEV: Camera Mapping This tab displays the current camera to device mapping used in the XProtect Access instance. <p></p> Tab Name Description DEV: Live Events This tab will display live events as they're received by the XProtect Access system when selected. If the client is closed, or the user switches to another view, the Live Events tab won't retain any memory of the events displayed. This memory-less behavior is something all three Live tabs have in common. <p></p> Tab Name Description DEV: Live State Changes This tab displays the live status changes of devices and servers. This tab has no memory. <p></p> Tab Name Description DEV: Live Credential Holder Changes This tab shows all credentials added to the XProtect Access system. This tab has no memory. <p></p>"},{"location":"Troubleshooting/Downgrades/","title":"Integration version downgrades","text":"<p>Here is the process required to uninstall the 4.3 version of the plugin.</p> <ol> <li>Go to the Programs and Features menu on the Milestone server. Uninstall the Milestone OnGuard XProtect Access program. </li> <li>Go to the Program and Features menu on the OnGuard server. Uninstall the Milestone OnGuard XProtect Access component</li> <li>Download the old version of the integration.</li> <li>On the OnGuard server: re-install the OnGuard XProtect Access Service.</li> <li>On the Milestone server: re-install the OnGuard XProtect Access MipPlugin.</li> <li>Open the XProtect Management Client. Reconfigure any connection properties in the General Settings tab of the XProtect Access instance as needed. Save the settings. Refresh the configuration of the XProtect Access instance.</li> </ol>"},{"location":"Troubleshooting/EnableDevTabs/","title":"Enabling developer tabs","text":"<p>Take these steps to enable the hidden developer tabs built into the XProtect Access instance.</p> <ol> <li>Select Options from the Tools menu of the Management Client.</li> <li>Go to the Access Control Settings tab of the Options dialog and select the Show development property panel option.</li> </ol> <p></p>"},{"location":"Troubleshooting/FloodingOnGuardReports/","title":"XProtect Access integration flooding OnGuard user transaction report","text":"<p>Milestone\u2019s XProtect system frequently requests status of OnGuard hardware. To get the current state of a hardware device, the integration must update the hardware status on the parent panel, then query for the device state. A transaction for each hardware status update/query is entered into OnGuard for the single sign-on (SSO) user.</p> <p>Customers making use of OnGuard\u2019s built-in User Transaction report from OnGuard\u2019s Sys Admin + Reports will see these transactions from the OnGuard XProtect Access integration under the SSO user in the report. It's not possible to filter the User Transaction report to omit the SSO user.</p> <p>Possible workarounds include:</p> <ul> <li>Install a compatible version of Crystal Reports and customize the report. However, OnGuard Technical Support, OAAP, etc., don't support custom reports.</li> <li>Contact the OnGuard Custom Solutions group and have them create/customize the reports.</li> </ul>"},{"location":"Troubleshooting/HardwareComms/","title":"OnGuard loses communication with access control hardware","text":"<p>Communication can fail for the following reasons:</p> <ol> <li>Firewall blocking traffic.</li> <li>The OnGuard LS Communication Server service isn't running or needs a restart.</li> <li>The OnGuard LS Web Service service isn't running or needs a restart.</li> </ol>"},{"location":"Troubleshooting/NoCardholderChanges/","title":"Not receiving cardholder or badge changes","text":"<p>If cardholder or badge changes aren't reflected in either the XProtect Management Client or Smart Client, verify that software events are enabled in OnGuard.</p>"},{"location":"Troubleshooting/NoXPAInstance/","title":"OnGuard XProtect Access instance not displayed in the XProtect Management Client","text":"<p>If XProtect is unable to communicate with the OnGuard XProtect Access instance, the instance won't appear in the Access Control section of the Management Client. This process should restore visibility:</p> On the Milestone server <ol> <li>Close the Management Client and Smart Client.</li> <li>Stop the XProtect Event Server. On the OnGuard server:</li> <li>Stop the OnGuard XProtect Access Service.</li> <li>Verify the required OnGuard services are running. <ul> <li>LS Event Context Provider.</li> <li>LS Message Broker.</li> <li>LS OpenAccess.</li> <li>LS Web Event Bridge.</li> <li>LS Web Service.</li> </ul> </li> <li>Start the OnGuard XProtect Access Service On the Milestone server:</li> <li>Start the XProtect Event Server and wait for it to begin running.</li> <li>Start the Management Client.</li> </ol> <p>If the instance still isn't in the Management Client, investigate the logs and contact Milestone Technical Support.</p>"},{"location":"Troubleshooting/OSDP/","title":"I/Os connected to OSDP readers are no longer detected","text":"<p>This is a known issue with OnGuard 7.4 Update 1 (7.4.457.69) where I/Os connected to OSDP readers are not detected in the OnGuard XProtect Access integration.</p> <p>For questions and information about this issue, please contact support at <code>oaaptechnical@carrier.com</code>.  Reference LenelS2 Bug DE40122.</p>"},{"location":"Troubleshooting/OpenAccessEventsFail/","title":"LS OpenAccess events fail in OnGuard Enterprise systems","text":"<p>This is a known issue with OnGuard 7.4 Update 1 (7.4.457.69) running in an Enterprise configuration. Devices don't send events through OpenAccess to the OnGuard XProtect Access integration.</p> <p>For questions and information about this issue, please contact support at <code>oaaptechnical@carrier.com</code>.  Reference LenelS2 Bug DE40122.</p>"},{"location":"Troubleshooting/OpenAccessStops/","title":"LS OpenAccess service automatically stops seconds after starting","text":"<p>There is a known issue with OnGuard caused by an Active Directory account logging into the OpenAccess service after it starts, which can cause OpenAccess to crash. The OnGuard XProtect Access Service tries to log into OpenAccess when both services are running. This can trigger the crash. The recommended workaround is to switch the Single Sign-On user to a local Windows account and adjust the services to use this same local Windows account.</p> <p>For questions and information about this issue, please contact support at <code>oaaptechnical@carrier.com</code>.  Reference LenelS2 Bug DE40122.</p>"},{"location":"Troubleshooting/PasswordError/","title":"XProtect 2021 R1 and R2 shows no error if OpenAccess - password is incorrect.","text":"<p>When running XProtect VMS 2021 R1 or 2021 R2, if a change to the configuration on any XProtect Access integration in the General Settings tab is saved, the system prompts for a password. This is the password for the account that authenticates between XProtect and the integrated access control system. If the wrong password is provided, there is no error or warning displayed and the integration is broken, without any warning, until the password is changed again to the correct one.</p> <p>This issue can occur during every XProtect Management Client session when the XProtect Access system configuration changes. When any information or setting controlled within the XProtect Access integration section of the Management Client is changed and saved, the system asks for a password.</p> <p></p> <p>To verify the correct settings are in place for the password and all other parameters controlling the connection between integrated access control systems and the XProtect Event Server, use the Refresh Configuration feature each time after entering the password, and each time the settings on the General Settings page change. If the connection breaks because the password is wrong, then the refresh configuration process produces an error.</p> <p></p>"},{"location":"Troubleshooting/RulesStopWorking/","title":"Access control rules stop working after upgrade to 4.0 or newer.","text":"<p>In versions 4.0 and newer of the XProtect Access LenelS2 OnGuard integration doors can't be a source for access control events or event categories in the XProtect VMS rule system. For existing rules to continue to function, and for new rules, readers must be the source for all events. To fix broken rules after a system upgrade, the source door objects must be replaced by the associated reader objects. Edit the existing rules, remove the doors as the source and replace them with readers. Below is the process to perform this change.</p> <ol> <li>Find all access control related rules in the XProtect Rules menu. Right-click each individual rule, and select Edit Rule... from the shortcut menu. </li> <li>Click the door hardware object used as the source of the event. </li> <li>The Select Sources window opens. Expand the source directory to identify the door hardware object(s) matching the Selected hardware objects. Associated to that door hardware object are one or more reader hardware objects.</li> <li>Choose the correct reader associated to the door for this rule. </li> <li>Select the reader hardware object from the directory and click the Add button.</li> <li>Select the door hardware object from the Selected list, and click the Remove button. </li> <li>Finish editing the rule.</li> <li>Perform this same process for all access control related rules in the XProtect VMS. Check the rules by selecting a rule and verifying the hardware object used as the source. </li> </ol>"},{"location":"Troubleshooting/VerifyInstall/","title":"OnGuard XProtect Access Service: MipPlugin post-install verification","text":"<p>Verify the MipPlugin (located on the XProtect Event Server host machine) was installed by checking the logs, following these steps:</p> <ol> <li>Right-click the OnGuard XProtect Access Service tray icon, and select View logs from the shortcut menu. </li> <li>Choose to open the Main Logs from the log viewer application. </li> <li>Verify that the following entries are in the log file:</li> </ol> Text Only<pre><code>Info 1 XPA Translator(s) found.\n\nInfo XPA Translator: 'LenelS2 OnGuard-4.x.xx.xxxxx' was successfully initialized.\n</code></pre> <p></p>"}]}